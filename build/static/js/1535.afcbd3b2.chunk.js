"use strict";(self.webpackChunknipa_panel_new=self.webpackChunknipa_panel_new||[]).push([[1535],{4564:function(e,n,i){i.d(n,{D:function(){return o}});var t=i(4165),l=i(5861),r=i(6149),a=i(8467).Z.actions,o=function(){return function(){var e=(0,l.Z)((0,t.Z)().mark((function e(n,i){var l;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.Z.basicDatasList();case 2:l=e.sent,n(a.basicDatasList(l));case 4:case"end":return e.stop()}}),e)})));return function(n,i){return e.apply(this,arguments)}}()}},1535:function(e,n,i){i.r(n),i.d(n,{default:function(){return ge}});var t,l=i(4165),r=i(5861),a=i(3433),o=i(1413),d=i(9439),s=i(9769),c=i(4150),u=i(2791),f=i(5443),v=i(2737),p=i(6718),m=i(2636),x=i(184),h=function(e){var n=e.items,i=e.value,t=e.handleChange;return(0,x.jsx)("div",{className:"mx-auto w-full flex px-3 items-center justify-between border-b mb-[19px] border-text-300",children:n.map((function(e,n){return(0,x.jsxs)("div",{className:"mx-1 cursor-pointer min-w-[70px] w-1/3 px-[10px] 2xl:px-[6px] relative flex items-center justify-center",onClick:function(){return t(e.value)},children:[(0,x.jsx)("p",{className:"mb-[20px] transition-all text-[14px] 2xl:text-[12px] leading-[20px] ".concat(e.value===i?"text-primary-main font-black 2xl:font-semibold":"text-text-500"),children:e.label}),(0,x.jsx)("div",{className:"w-full ".concat(e.value===i?"h-[3px] rounded-t-[2px]":"h-0"," bg-primary-main transition-all absolute bottom-0")})]},n)}))})},b=i(4942),Z=i(6995),g=i(7139),j=i(4370),y=function(e){var n=e.checked,i=e.setChecked;return(0,x.jsx)("div",{onClick:function(){i(!n)},className:"w-[36px] h-[20px] rounded-[10px] border ".concat(n?"border-primary-main":"border-text-500"," flex items-center ").concat(n?"justify-start":"justify-end"," p-[2px] cursor-pointer"),children:(0,x.jsx)("div",{className:"w-4 h-4 ".concat(n?"bg-primary-main":"bg-text-500"," rounded-full")})})},_=function(e){var n=e.checked,i=e.setChecked,t=e.label;return(0,x.jsxs)("div",{className:"w-full p-[8px] h-[48px] flex items-center justify-between border border-text-400 rounded-[8px] transition-al",children:[(0,x.jsx)("p",{className:"cursor-pointer text-text-800 text-[14px]",onClick:function(){return i(!n)},children:t}),(0,x.jsx)(y,{checked:n,setChecked:i})]})},w=i(8923),F=i(9134),N=i(5705),k=function(e){var n=e.open,i=e.handleClose,t=e.field,l=e.handleAddOption,r=e.selectedOption,a={index:(null===r||void 0===r?void 0:r.index)||-1,id:(null===r||void 0===r?void 0:r.index)||0,fieldName:(null===r||void 0===r?void 0:r.label)||"",fieldValue:(null===r||void 0===r?void 0:r.value)||"",server_id:null===r||void 0===r?void 0:r.server_id},o=(0,N.TA)({initialValues:a,onSubmit:function(e){console.log("values",e),l(e),o.setFieldValue("fieldName",""),o.setFieldValue("fieldValue",""),o.setFieldValue("index",-1),o.setFieldValue("server_id",-1),null===i||void 0===i||i()}});(0,u.useEffect)((function(){r&&(o.setFieldValue("fieldName",r.label),o.setFieldValue("fieldValue",r.value),o.setFieldValue("index",r.index),o.setFieldValue("id",r.id),o.setFieldValue("server_id",r.server_id))}),[r]);var d=function(){null===i||void 0===i||i(),o.setFieldValue("fieldName",""),o.setFieldValue("fieldValue",""),o.setFieldValue("index",-1)};return(0,x.jsxs)(F.Z,{headerText:"".concat(r?"\u0648\u06cc\u0631\u0627\u06cc\u0634":"\u0627\u0641\u0632\u0648\u062f\u0646"," ").concat(t.label),headerIcon:(0,x.jsx)(j.Z,{}),open:n,handleClose:d,children:[(0,x.jsx)(F.Z.Content,{children:(0,x.jsx)("div",{className:"p-7",children:(0,x.jsx)("form",{onSubmit:o.handleSubmit,className:"w-full",children:(0,x.jsxs)("div",{className:"mt-7 w-full grid grid-cols-1 gap-x-5 gap-y-7",children:[(0,x.jsx)(w.Z,{name:"fieldName",label:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u0646\u0645\u0627\u06cc\u06cc\u062f",formik:o}),(0,x.jsx)(w.Z,{name:"fieldValue",label:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u0646\u0645\u0627\u06cc\u06cc\u062f",formik:o})]})})})}),(0,x.jsx)(F.Z.Footer,{children:(0,x.jsxs)("div",{className:"mt-20 px-7 flex justify-between items-center py-[25px] border border-text-300",children:[(0,x.jsx)("div",{className:"w-[126px]",children:(0,x.jsx)(m.Z,{text:"\u0627\u0646\u0635\u0631\u0627\u0641",onClick:d,gray:!0})}),(0,x.jsx)("div",{className:"w-[182px]",children:(0,x.jsx)(m.Z,{text:"".concat(r?"\u0648\u06cc\u0631\u0627\u06cc\u0634":"\u0627\u0641\u0632\u0648\u062f\u0646"," ").concat(t.label),onClick:function(){o.submitForm()}})})]})})]})},O=i(9230),C=i(745),I=i(4564),S=function(e){var n,i=e.selectedField,t=e.handleUpdateField,l=e.handleAddOption,r=e.handleDeleteOption,a=e.handleUpdateOption,s=e.onlyImage,c=e.setOnlyImage,f=e.required,p=e.setRequired,h=e.fromBasicData,y=e.setFromBasicData,F=(0,u.useState)(!1),N=(0,d.Z)(F,2),S=N[0],E=N[1],D=(0,u.useState)(),V=(0,d.Z)(D,2),q=V[0],R=V[1],T=(0,v.C)((function(e){return e.basicData.basicDatas})),B=(0,O.$G)().t,L=(0,v.T)();console.log("selected",i);var M=function(e){if(i){var n=(0,o.Z)({},i);if("basic_data"==e.target.name){var l,r=null===T||void 0===T?void 0:T.find((function(n){return n.id==e.target.value}));if(console.log("basicDataTmp",r),r)n=(0,o.Z)((0,o.Z)({},n),{},(l={},(0,b.Z)(l,e.target.name,r),(0,b.Z)(l,"basic_data_id",null===r||void 0===r?void 0:r.id),(0,b.Z)(l,"basicDataItems",r.items.map((function(e){return{id:e.id,label:(0,x.jsx)("p",{children:e.name}),server_id:e.id,value:e.code}}))),l)),t((0,o.Z)({},n))}else n=(0,o.Z)((0,o.Z)({},n),{},(0,b.Z)({},e.target.name,e.target.value)),t((0,o.Z)({},n))}};(0,u.useEffect)((function(){!T&&L((0,I.D)())}),[]);var U=function(e){var n;(console.log("ite",e),null!==e&&void 0!==e&&e.label)&&R({index:null===i||void 0===i||null===(n=i.options)||void 0===n?void 0:n.findIndex((function(n){return n.value===e.value})),value:e.value,label:e.label.props.children,id:e.id,server_id:e.server_id});i&&null!==i&&void 0!==i&&i.options&&E(!0)};return(0,x.jsx)("div",{children:i?i.fromRelatedFields?(0,x.jsx)("p",{children:"\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u0632 \u0637\u0631\u06cc\u0642 \u0627\u06cc\u0646 \u0641\u0631\u0645 \u0642\u0627\u0628\u0644 \u0648\u06cc\u0631\u0627\u06cc\u0634 \u0646\u0645\u06cc \u0628\u0627\u0634\u062f"}):i.readOnly?(0,x.jsx)("p",{children:"\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0642\u0627\u0628\u0644 \u0648\u06cc\u0631\u0627\u06cc\u0634 \u0646\u0645\u06cc \u0628\u0627\u0634\u062f"}):(0,x.jsxs)("div",{className:"w-full flex flex-col items-start justify-start px-4",children:[(0,x.jsxs)("p",{className:"text-text-450 mb-[20px]",children:["\u0646\u0648\u0639 \u0641\u06cc\u0644\u062f: ",i.type]}),(0,x.jsx)(w.Z,{className:"mb-[30px]",name:"label",label:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",formik:{handleChange:function(e){return M(e)},values:{label:i.label}}}),(0,x.jsx)(w.Z,{className:"mb-[30px]",name:"name",label:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f",formik:{handleChange:function(e){return M(e)},values:{name:i.name}}}),(0,x.jsx)(w.Z,{className:"group",name:"placeholder",label:"\u0645\u062a\u0646 \u062c\u0627\u06cc\u06af\u0632\u06cc\u0646",type:"text",placeholder:"\u0645\u062a\u0646 \u062c\u0627\u06cc\u06af\u0632\u06cc\u0646",formik:{handleChange:function(e){return M(e)},values:{placeholder:i.placeholder}}}),(0,x.jsx)("div",{className:"w-full mt-[30px]",children:(0,x.jsx)(_,{checked:f,setChecked:p,label:"\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f"})}),i.options?(0,x.jsx)("div",{className:"w-full mt-[30px]",children:(0,x.jsx)(_,{checked:h,setChecked:y,label:B("fromBasicDatas")||""})}):"",i.options&&h?(0,x.jsx)(C.Z,{className:"group mt-[30px]",name:"basic_data",label:"\u062f\u0627\u062f\u0647 \u0627\u0648\u0644\u06cc\u0647",options:T?T.map((function(e){return{label:(0,x.jsx)("p",{children:e.name}),value:e.id.toString()}})):[],placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:function(e){return M(e)},values:{basic_data:null===(n=i.basic_data)||void 0===n?void 0:n.id.toString()}}}):"","uploadFile"===i.type&&(0,x.jsx)("div",{className:"w-full mt-[30px]",children:(0,x.jsx)(_,{checked:s,setChecked:c,label:B("onlyImage")||""})}),i.options&&!h?(0,x.jsx)(k,{open:S,handleClose:function(){R(void 0),E(!1)},field:i,handleAddOption:function(e,n){i&&(void 0!==e.index&&-1!==e.index?a(i.id,{label:(0,x.jsx)("p",{children:e.fieldName}),value:e.fieldValue.toString(),id:e.id,server_id:e.server_id},e.index):l(i.id,{label:(0,x.jsx)("p",{children:e.fieldName}),value:e.fieldValue.toString()}))},selectedOption:q}):"",i.options&&!h?(0,x.jsxs)("div",{className:"w-full mt-[25px]",children:[i.options.map((function(e,n){return(0,x.jsxs)("div",{className:"mb-[10px] h-14 text-[14px] font-semibold flex items-center rounded-[8px] px-[18px] justify-between bg-text-250",children:[(0,x.jsx)("p",{children:e.label}),(0,x.jsxs)("div",{className:"flex",children:[(0,x.jsx)("div",{onClick:function(){return U(e)},className:"w-[24px] h-[24px] me-1 cursor-pointer hover:bg-text-300 flex items-center justify-center rounded-[4px]",children:(0,x.jsx)(Z.Z,{className:"w-[20px] h-[20px]"})}),(0,x.jsx)("div",{onClick:function(){return function(e){i&&r(i.id,e.value,e.server_id)}(e)},className:"w-[24px] h-[24px] ms-1 cursor-pointer hover:bg-text-300 flex items-center justify-center rounded-[4px]",children:(0,x.jsx)(g.Z,{className:"w-[20px] h-[20px]"})})]})]},n)})),(0,x.jsx)("div",{className:"w-full flex items-center justify-end",children:(0,x.jsx)("div",{className:"w-[111px] mt-[30px] float-left",children:(0,x.jsx)(m.Z,{icon:(0,x.jsx)(j.Z,{}),text:"\u0627\u0641\u0632\u0648\u062f\u0646",onClick:U})})})]}):""]}):(0,x.jsx)("p",{children:"\u0644\u0637\u0641\u0627 \u06cc\u06a9 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0628\u0631\u0627\u06cc \u0648\u06cc\u0631\u0627\u06cc\u0634 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"})})},E=i(1929),D=i(713),V=i(9803),q=function(e){var n=e.icon,i=e.label,t=e.onClick,l=e.type,r=e.id;return(0,x.jsxs)("div",{onClick:function(){return t(l,r)},className:"w-full h-[80px] flex flex-col items-center justify-center bg-text-200 rounded-[6px] cursor-pointer",children:[(0,x.jsx)("div",{children:n}),(0,x.jsx)("p",{className:"text-[12px] mt-[10px] text-text-700 font-medium",children:i})]})},R=["title","titleId"];function T(){return T=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e},T.apply(this,arguments)}function B(e,n){if(null==e)return{};var i,t,l=function(e,n){if(null==e)return{};var i,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||(l[i]=e[i]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(l[i]=e[i])}return l}function L(e,n){var i=e.title,l=e.titleId,r=B(e,R);return u.createElement("svg",T({width:26,height:26,viewBox:"0 0 26 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":l},r),i?u.createElement("title",{id:l},i):null,t||(t=u.createElement("path",{d:"M8.666 8.666H13M8.666 17.332H13M8.666 13h8.667M9.75 23.833h6.5c5.416 0 7.583-2.167 7.583-7.584v-6.5c0-5.416-2.166-7.583-7.583-7.583h-6.5c-5.417 0-7.583 2.167-7.583 7.583v6.5c0 5.417 2.166 7.584 7.583 7.584z",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}var M,U,A=u.forwardRef(L),P=(i.p,["title","titleId"]);function z(){return z=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e},z.apply(this,arguments)}function G(e,n){if(null==e)return{};var i,t,l=function(e,n){if(null==e)return{};var i,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||(l[i]=e[i]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(l[i]=e[i])}return l}function $(e,n){var i=e.title,t=e.titleId,l=G(e,P);return u.createElement("svg",z({width:39,height:24,viewBox:"0 0 39 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":t},l),i?u.createElement("title",{id:t},i):null,M||(M=u.createElement("path",{d:"M14.027 23h11.165c9.305 0 13.028-2.2 13.028-7.7V8.7c0-5.5-3.723-7.7-13.028-7.7H14.027C4.722 1 1 3.2 1 8.7v6.6C1 20.8 4.722 23 14.027 23z",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),U||(U=u.createElement("path",{d:"M7.62 14.227c0-.344-.002-.693-.007-1.045a22.997 22.997 0 0 0-.031-1.049c-.016-.346-.04-.687-.07-1.02a10.488 10.488 0 0 0-.134-.96 7.31 7.31 0 0 0-.207-.868 4.177 4.177 0 0 0-.305-.744l.998-.622c.135.211.249.433.34.665.091.233.167.474.227.724.063.248.113.504.153.767.041.261.08.527.117.799.026.208.047.434.063.676.015.243.027.49.035.74.01.25.017.498.02.744l.003.688v.505H7.621zM21.026 8.013c.03.188.051.36.067.517.016.156.023.3.023.434 0 .248-.036.493-.109.736-.073.24-.183.456-.329.65-.143.19-.323.345-.54.465a1.56 1.56 0 0 1-.755.176c-.068 0-.134-.001-.2-.004a2.127 2.127 0 0 1-.183-.024 23.971 23.971 0 0 1 .11 1.71c.007.29.01.574.01.854.003.279.005.54.005.786h-1.201c0-.438-.006-.88-.016-1.323a20.168 20.168 0 0 0-.063-1.287 12.676 12.676 0 0 0-.14-1.174 5.868 5.868 0 0 0-.251-.994l-.114-.274a3.357 3.357 0 0 0-.176-.387 4.952 4.952 0 0 0-.101-.192l1.01-.642a3.706 3.706 0 0 1 .25.458c.036.073.073.154.11.243l.124.297c.047.11.096.212.145.305.052.094.111.175.176.243a.764.764 0 0 0 .22.16.665.665 0 0 0 .285.051.48.48 0 0 0 .31-.094.498.498 0 0 0 .156-.223.923.923 0 0 0 .055-.3 7.02 7.02 0 0 0 .007-.326c0-.099-.006-.195-.02-.29a6.779 6.779 0 0 0-.046-.34l1.181-.211zM33.377 8.005l.078.43c.02.118.036.222.047.314a3.253 3.253 0 0 1 .035.47c0 .2-.026.4-.078.598a1.652 1.652 0 0 1-.247.536 1.3 1.3 0 0 1-.422.383c-.17.1-.372.15-.607.15a1.387 1.387 0 0 1-.693-.176 1.2 1.2 0 0 1-.23-.177c-.134.144-.28.25-.439.32a1.412 1.412 0 0 1-.563.103h-.145a1.181 1.181 0 0 1-.133-.016c.029.245.052.511.07.798.019.287.032.58.04.877.01.297.017.592.02.884.004.29.007.56.007.81h-1.213a11.068 11.068 0 0 0 .012-.47c.002-.09.004-.178.004-.262a7.2 7.2 0 0 0 .003-.207 23.603 23.603 0 0 0-.05-1.518c-.021-.272-.051-.546-.09-.822a8.511 8.511 0 0 0-.15-.818 6.242 6.242 0 0 0-.226-.779c-.091-.25-.2-.486-.325-.708l1.068-.622a3.06 3.06 0 0 1 .215.391c.04.076.081.163.126.263.044.096.095.21.152.34.058.133.106.243.145.329.042.083.084.15.125.2.042.049.09.084.141.105.053.018.12.027.204.027a.268.268 0 0 0 .176-.055.362.362 0 0 0 .11-.144.745.745 0 0 0 .058-.216c.01-.08.016-.164.016-.25 0-.096-.005-.2-.016-.31l-.039-.406 1.104-.157.027.263c.01.099.023.203.039.313.016.107.035.214.059.32.023.107.052.203.086.286.036.084.08.151.129.204.05.052.108.078.176.078a.147.147 0 0 0 .114-.047.362.362 0 0 0 .066-.121.75.75 0 0 0 .031-.153 1.05 1.05 0 0 0 .008-.266 2.124 2.124 0 0 0-.02-.168l-.042-.27a29.256 29.256 0 0 0-.075-.43l1.111-.224z",fill:"#303030"})))}var H,J,W=u.forwardRef($),K=(i.p,["title","titleId"]);function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e},Q.apply(this,arguments)}function X(e,n){if(null==e)return{};var i,t,l=function(e,n){if(null==e)return{};var i,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||(l[i]=e[i]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(l[i]=e[i])}return l}function Y(e,n){var i=e.title,t=e.titleId,l=X(e,K);return u.createElement("svg",Q({width:39,height:24,viewBox:"0 0 39 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":t},l),i?u.createElement("title",{id:t},i):null,H||(H=u.createElement("path",{d:"M14.027 23h11.165c9.305 0 13.028-2.2 13.028-7.7V8.7c0-5.5-3.723-7.7-13.028-7.7H14.027C4.722 1 1 3.2 1 8.7v6.6C1 20.8 4.722 23 14.027 23z",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),J||(J=u.createElement("path",{d:"m6 10.065 3.883 3.872 3.883-3.872",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}var ee=u.forwardRef(Y),ne=(i.p,i(9875)),ie=i(5601),te=ne.Z.actions,le=i(7047),re=function(e){var n=e.addElement,i=e.relatedFields,t=(0,O.$G)().t,a=(0,v.C)((function(e){return e.forms.formFieldTypes})),o=(0,v.T)();(0,u.useEffect)((function(){a||o(function(){var e=(0,r.Z)((0,l.Z)().mark((function e(n,i){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie.Z.getFormFieldTypes();case 2:t=e.sent,n(te.getFormFieldTypes(t));case 4:case"end":return e.stop()}}),e)})));return function(n,i){return e.apply(this,arguments)}}())}),[]);var d=function(e){switch(e){case"TextBlock":default:return(0,x.jsx)(E.Z,{});case"Frame":return(0,x.jsx)(A,{});case"NumericField":return(0,x.jsx)(W,{});case"ExportCurve":return(0,x.jsx)(D.Z,{});case"Dropdown":return(0,x.jsx)(ee,{});case"TickSquare":return(0,x.jsx)(V.Z,{})}};return(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"grid grid-cols-3 gap-[10px] px-4",children:a?a.map((function(e,i){return(0,x.jsx)(q,{id:e.id,type:e.type,onClick:n,icon:d(e.icon),label:e.label},e.id)})):(0,x.jsx)(x.Fragment,{children:Array.from(Array(9).keys()).map((function(e,n){return(0,x.jsx)(le.Z,{variant:"rounded",width:80,height:80,animation:"wave"},n)}))})}),(0,x.jsx)("div",{className:"px-4",children:i?(0,x.jsx)(C.Z,{className:"group mt-[30px]",name:"relatedFields",label:t("selectFromRelatedFields"),options:i?i.map((function(e){var n,i,l;return{label:(0,x.jsxs)("p",{children:[e.label," ",t("fromStep")," ",null===(n=e.form)||void 0===n||null===(i=n.step)||void 0===i?void 0:i.step_name]}),value:null===(l=e.server_id)||void 0===l?void 0:l.toString(),type:e.type}})):[],placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:function(e){console.log("e",e),n(e.target.type,e.target.value,!0)},values:{relatedFields:0}}}):""})]})},ae=i(6151),oe=function(e){var n,i=e.conditionalfields,t=e.formElements,l=e.condition,r=e.setCondition,s=e.deleteCondition,f=e.saveCondition,v=(0,u.useState)(),p=(0,d.Z)(v,2),m=p[0],h=p[1],b=(0,u.useState)([]),Z=(0,d.Z)(b,2),j=Z[0],y=Z[1],_=(0,u.useState)(),w=(0,d.Z)(_,2),F=w[0],N=w[1],k=(0,u.useState)(),I=(0,d.Z)(k,2),S=I[0],E=I[1],D=(0,O.$G)().t;(0,u.useEffect)((function(){if(l.field&&l.operation&&l.relationField&&l.values){var e=i.find((function(e){return e.id.toString()==l.field})),n=t.find((function(e){return e.id.toString()==l.relationField}));e&&n&&l.values&&(console.log(),h({label:e.label,value:e.id.toString(),options:(null===e||void 0===e?void 0:e.basicDataItems)||e.options}),N(l.operation),E({label:n.label,value:n.id.toString()}),y(l.values))}}),[l,i,t]);var V=function(e){var n=(0,o.Z)((0,o.Z)({},e),{},{saved:!1});r((0,o.Z)({},n))};return console.log("selecccc",m),(0,x.jsxs)("div",{className:"w-full flex flex-col items-start justify-start px-4 border-b pb-[30px] border-text-400 mb-[18px]",children:[(0,x.jsx)(C.Z,{className:"group mb-[30px]",name:"condField",label:"\u0641\u06cc\u0644\u062f",options:i&&i.map((function(e){return{label:(0,x.jsx)("p",{children:e.label}),value:e.id.toString()}})),placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:function(e){var n=i.find((function(n){return n.id.toString()==e.target.value}));console.log("seleeee",n),h((0,o.Z)((0,o.Z)({},e),{},{options:(null===n||void 0===n?void 0:n.basicDataItems)||(null===n||void 0===n?void 0:n.options)})),y([]),V((0,o.Z)((0,o.Z)({},l),{},{field:e.target.value}))},values:{condField:null===m||void 0===m?void 0:m.value}}}),(0,x.jsx)(C.Z,{className:"group ".concat(j.length>0?"mb-[15px]":"mb-[30px]"),name:"condFieldValue",label:"\u0628\u0631\u0627\u0628\u0631",options:m&&(null===m||void 0===m||null===(n=m.options)||void 0===n?void 0:n.map((function(e){return{label:e.label,value:e.id}}))),placeholder:m?"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f":"\u0627\u0628\u062a\u062f\u0627 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:function(e){var n=null===m||void 0===m?void 0:m.options;j.findIndex((function(n){return n.id==e.target.value}))>-1||(y([].concat((0,a.Z)(j),[(0,o.Z)({},n.find((function(n){return n.id==e.target.value})))])),V((0,o.Z)((0,o.Z)({},l),{},{values:[].concat((0,a.Z)(j),[(0,o.Z)({},n.find((function(n){return n.id==e.target.value})))])})))},values:{condFieldValue:null}}}),j.length>0&&(0,x.jsx)("div",{className:"flex items-center justify-start w-full mb-[30px]",children:j.map((function(e,n){return(0,x.jsxs)("div",{className:"w-[97px] h-[48px] rounded-[24px] border border-text-400 flex items-center justify-between pe-2 ps-4 me-2",children:[(0,x.jsx)("p",{className:"text-[14px]",children:e.label}),(0,x.jsx)("div",{onClick:function(){return function(e){var n=j.findIndex((function(n){return n.value==e.value}));if(n>-1){var i=j;i.splice(n,1),y((0,a.Z)(i)),V((0,o.Z)((0,o.Z)({},l),{},{values:(0,a.Z)(i)}))}}(e)},className:"cursor-pointer",children:(0,x.jsx)(g.Z,{className:"w-[20px] h-[20px]"})})]},n)}))}),(0,x.jsx)(C.Z,{className:"group mb-[30px]",name:"operation",label:"\u0639\u0645\u0644\u06cc\u0627\u062a",options:[{label:(0,x.jsx)("p",{children:"\u0646\u0645\u0627\u06cc\u0634"}),value:"show"},{label:(0,x.jsx)("p",{children:"\u0639\u062f\u0645 \u0646\u0645\u0627\u06cc\u0634"}),value:"hide"}],placeholder:"\u0639\u0645\u0644\u06cc\u0627\u062a",formik:{handleChange:function(e){N(e.target),V((0,o.Z)((0,o.Z)({},l),{},{operation:e.target}))},values:{operation:null===F||void 0===F?void 0:F.value}}}),(0,x.jsx)(C.Z,{className:"group mb-[30px]",name:"relationField",label:"\u0641\u06cc\u0644\u062f \u0648\u0627\u0628\u0633\u062a\u0647",options:t&&m&&t.filter((function(e){return e.id.toString()!=m.value})).map((function(e){return{label:(0,x.jsx)("p",{children:e.label}),value:e.id.toString()}})),placeholder:m?"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f":"\u0627\u0628\u062a\u062f\u0627 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:function(e){var n=t.find((function(n){return n.id.toString()==e.target.value}));n&&(E({label:n.label,value:n.id.toString()}),V((0,o.Z)((0,o.Z)({},l),{},{relationField:n.id})))},values:{relationField:null===S||void 0===S?void 0:S.value}}}),(0,x.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,x.jsxs)(ae.Z,{onClick:function(){s(l.id)},className:"h-[48px] ".concat(null!==l&&void 0!==l&&l.saved?"w-full":"w-[calc(50%-8px)] me-2"," !rounded-[8px]  !border !border-solid !border-error-primary !text-error-primary "),children:[(0,x.jsx)(g.Z,{}),(0,x.jsx)("p",{className:"text-[14px] font-bold ms-1",children:D("deleteCondition")})]}),!(null!==l&&void 0!==l&&l.saved)&&(0,x.jsxs)(ae.Z,{onClick:function(){f(l.id)},className:"h-[48px] w-[calc(50%-8px)] !rounded-[8px] ms-2 !border !border-solid !border-success-primary !text-success-primary",children:[(0,x.jsx)(c.Z,{}),(0,x.jsx)("p",{className:"text-[14px] font-bold ms-1",children:D("saveCondition")})]})]})]})},de=i(174),se=function(e){var n=e.conditionalfields,i=e.formElements,t=e.saveConditions,l=e.savedConditions,r=(0,u.useState)((0,a.Z)(l)),o=(0,d.Z)(r,2),s=o[0],c=o[1];console.log("condiii",s);var f=(0,O.$G)().t,v=function(e){var n=s.findIndex((function(n){return n.id==e.id}));if(n>-1){var i=s;i[n]=e,c((0,a.Z)(i))}},p=function(e){var n=s.findIndex((function(n){return n.id==e}));if(n>-1){var i=s;i.splice(n,1),c((0,a.Z)(i))}t((0,a.Z)(s)),de.Z.success(f("conditionDeleted"))},h=function(e){var l=s.findIndex((function(n){return n.id==e}));if(l>-1){var r=s[l];if(r.field&&r.operation&&r.values&&r.values.length>0&&r.relationField)if(n.findIndex((function(e){return e.id==r.field}))>-1){var o=i.findIndex((function(e){return e.id==r.relationField}));if(o>-1){if(i[o].readOnly)return void de.Z.error("\u0641\u06cc\u0644\u062f \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647 \u062f\u0631 \u0641\u0631\u0645 \u0642\u0627\u0628\u0644 \u0634\u0631\u0637 \u06af\u0630\u0627\u0631\u06cc \u0646\u06cc\u0633\u062a");var d=s;d[l].saved=!0,c((0,a.Z)(d)),t(s),de.Z.success("\u0634\u0631\u0637 \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f")}else de.Z.error("\u0641\u06cc\u0644\u062f \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647 \u062f\u0631 \u0641\u0631\u0645 \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f")}else de.Z.error("\u0641\u06cc\u0644\u062f \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647 \u062f\u0631 \u0641\u0631\u0645 \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f");else de.Z.error("\u0644\u0637\u0641\u0627 \u062a\u0645\u0627\u0645 \u0641\u06cc\u0644\u062f \u0647\u0627\u06cc \u0634\u0631\u0637 \u0631\u0627 \u067e\u0631 \u06a9\u0646\u06cc\u062f")}};return(0,x.jsxs)("div",{children:[s&&s.map((function(e,t){return(0,x.jsx)(oe,{conditionalfields:n,formElements:i,condition:e,setCondition:v,saveCondition:h,deleteCondition:p},t)})),(0,x.jsx)("div",{className:"w-full px-[16px]",children:(0,x.jsx)(m.Z,{icon:(0,x.jsx)(j.Z,{}),text:"\u0627\u0641\u0632\u0648\u062f\u0646 \u0634\u0631\u0637 \u062c\u062f\u06cc\u062f",onClick:function(){n.length>0&&i.length>=2?c([].concat((0,a.Z)(s),[{id:Math.floor(1e3*Math.random()),field:null,operation:null,values:[],relationField:null,saved:!1}])):de.Z.error("\u0641\u06cc\u0644\u062f \u0647\u0627\u06cc \u0627\u06cc\u062c\u0627\u062f \u0634\u062f\u0647 \u0628\u0631\u0627\u06cc \u0627\u06cc\u062c\u0627\u062f \u0634\u0631\u0637 \u0641\u0631\u0645 \u0645\u0646\u0627\u0633\u0628 \u0646\u0645\u06cc \u0628\u0627\u0634\u0646\u062f")}})})]})},ce=function(e){var n=e.handleChangeTab,i=e.selectedTab,t=e.addElement,l=e.selectedField,r=e.handleUpdateField,a=e.handleAddOption,o=e.handleDeleteOption,d=e.handleUpdateOption,s=e.setOnlyImage,c=e.setRequired,u=e.formElements,f=e.saveConditions,v=e.savedConditions,p=e.setFromBasicData,m=e.relatedFields,b=function(e){f(e)};return(0,x.jsxs)("div",{className:"min-h-[800px] basis-1/4 bg-white pt-[20px] me-3 border border-text-300",children:[(0,x.jsx)(h,{handleChange:n,items:[{label:"\u0627\u0644\u0645\u0627\u0646 \u0647\u0627",value:"elements"},{label:"\u0648\u06cc\u0631\u0627\u06cc\u0634 \u0627\u0644\u0645\u0627\u0646",value:"editElement"},{label:"\u0634\u0631\u0637 \u0647\u0627\u06cc \u0641\u0631\u0645",value:"formConditions"}],value:i}),function(){switch(i){case"elements":return(0,x.jsx)(re,{addElement:t,relatedFields:m});case"editElement":return(0,x.jsx)(S,{handleUpdateField:r,selectedField:l,handleAddOption:a,handleUpdateOption:d,handleDeleteOption:o,onlyImage:(null===l||void 0===l?void 0:l.onlyImage)||!1,setOnlyImage:s,required:(null===l||void 0===l?void 0:l.required)||!1,setRequired:c,fromBasicData:!(null===l||void 0===l||!l.basic_data_id),setFromBasicData:p});case"formConditions":return(0,x.jsx)(se,{conditionalfields:u.filter((function(e){return e.options})),formElements:u,saveConditions:b,savedConditions:v});default:return(0,x.jsx)(re,{addElement:t})}}()]})},ue=i(1164),fe=i(9550),ve=i(9543),pe=i(1188),me=i(9351),xe=function(e){var n=e.formElements,i=e.setFormElements,t=e.handleSelectField,l=e.lastId,r=e.setLastId,d=e.selectedField,s=e.deleteItem,c=e.saveFormLoading,f=(0,O.$G)(["common","validations"]).t;console.log("el",n);var v=function(e){var n,i;return(0,x.jsxs)("div",{className:"flex",children:[(0,x.jsxs)("div",{className:"flex opacity-0 pointer-events-none\tgroup-hover:pointer-events-auto\t group-hover:opacity-100 transition-all ",children:[(!e.readOnly||e.fromRelatedFields)&&(0,x.jsx)("div",{onClick:function(){return m(e)},id:"deleteItem",className:"cursor-pointer ms-2 w-[30px] h-[30px] rounded-full border border-error-primary flex items-center justify-center",children:(0,x.jsx)(pe.Z,{className:"w-[16px] h-[16px] text-error-primary pointer-events-none"})}),!e.fromRelatedFields&&(0,x.jsx)("div",{onClick:function(){return p(e)},className:"cursor-pointer ms-2 w-[30px] h-[30px] rounded-full border border-success-primary flex items-center justify-center",children:(0,x.jsx)(ue.Z,{className:"w-[16px] h-[16px] text-success-primary"})})]}),e.fromRelatedFields&&(0,x.jsxs)("div",{className:"ms-3 bg-secondary-main flex items-center justify-center px-2 py-0.5 rounded-full text-[11px]",children:[f("fromStep")," ",null===(n=e.form)||void 0===n||null===(i=n.step)||void 0===i?void 0:i.step_name]})]})},p=function(e){var t=(0,a.Z)(n),d=t.indexOf(e);d>-1&&(t.splice(d+1,0,(0,o.Z)((0,o.Z)({},e),{},{id:l+1,server_id:null,label:e.label+" "+f("copy"),name:e.name+(l+1).toString(),placeholder:e.placeholder+(l+1).toString(),readOnly:!1})),i(t),r(l+1))},m=function(e){s(e)},h=(0,u.useRef)(),b=(0,u.useRef)(),Z=function(e){var t=(0,a.Z)(n),l=t[h.current];t.splice(h.current,1),t.splice(b.current,0,l),h.current=null,b.current=null,i(t)};return(0,x.jsxs)("div",{className:"px-4 py-6 draggable grid grid-cols-1 gap-9",children:[0===n.length&&!c&&(0,x.jsxs)("div",{className:"flex flex-col items-center justify-center mt-8",children:[(0,x.jsx)("div",{className:"w-[50px] rounded-full h-[50px] bg-primary-main text-white flex items-center justify-center",children:(0,x.jsx)(fe.Z,{})}),(0,x.jsx)("p",{className:"text-gray-400 text-[16px] font-bold mt-4",children:f("addFieldToStart")})]}),n.map((function(e,n){return(0,x.jsxs)("div",{onDragStart:function(e){return i=n,void(h.current=i);var i},onDragEnter:function(e){return i=n,void(b.current=i);var i},onDragEnd:Z,onClick:function(n){"deleteItem"!==n.target.id&&t(e)},draggable:!0,className:"flex",children:[(0,x.jsx)("div",{className:"me-3 cursor-move ".concat((null===d||void 0===d?void 0:d.id)===e.id?"text-primary-main":""),children:(0,x.jsx)(ve.Z,{})}),(0,me.lw)(e,v,void 0,!0)]},n)}))]})},he=i(7689),be=i(5138),Ze=i(2841),ge=function(){var e,n=(0,v.T)(),i=(0,he.UO)(),t=i.code,h=i.step_id,b=(0,v.C)((function(e){return e.forms.formFieldTypes}));(0,u.useEffect)((function(){n((0,f.y)(!0))}));var Z=(0,u.useState)("elements"),g=(0,d.Z)(Z,2),j=g[0],y=g[1],_=function(e){console.log("value",e),"formConditions"===e&&fe(),y(e)},w=(0,u.useState)([]),F=(0,d.Z)(w,2),N=F[0],k=F[1],C=(0,u.useState)([]),I=(0,d.Z)(C,2),S=I[0],E=I[1],D=(0,u.useState)(),V=(0,d.Z)(D,2),q=V[0],R=V[1],T=(0,u.useState)([]),B=(0,d.Z)(T,2),L=B[0],M=B[1],U=(0,u.useState)(!0),A=(0,d.Z)(U,2),P=A[0],z=A[1],G=(0,v.C)((function(e){return e.basicData.basicDatas})),$=(0,u.useState)(0),H=(0,d.Z)($,2),J=H[0],W=H[1],K=(0,v.C)((function(e){return e.products.productStepInfo})),Q=(0,u.useState)(0),X=(0,d.Z)(Q,2),Y=X[0],ee=X[1],ne=(0,O.$G)(["common","validations"]).t,te=(0,he.s0)();(0,u.useEffect)((function(){return n((0,be.bJ)(parseInt(h||"0"))),function(){n((0,f.y)(!1)),n((0,be.bJ)(parseInt("0")))}}),[]);var le=function(e){e?(R(e),_("editElement")):(R(void 0),_("elements"))},re=function(){var e=(0,r.Z)((0,l.Z)().mark((function e(n){var i,t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,z(!0),!n.server_id){e.next=5;break}return e.next=5,ie.Z.deleteItem(n.server_id,J);case 5:i=(0,a.Z)(N),(t=i.indexOf(n))>-1&&(i.splice(t,1),k(i),n.id==(null===q||void 0===q?void 0:q.id)&&le(void 0)),de.Z.success(ne("fieldDeletedSuccessfully")),z(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),z(!1);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){var e,n,i,t;K&&b&&((null===(e=K.forms)||void 0===e?void 0:e.length)>0?(z(!0),W(null===(n=K.forms)||void 0===n?void 0:n[0].id),ae(null===(i=K.forms)||void 0===i?void 0:i[0].id)):ue(K.global_step,null===(t=K.product)||void 0===t?void 0:t.count_type))}),[K,b]);var ae=function(){var e=(0,r.Z)((0,l.Z)().mark((function e(n){var i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie.Z.getForm(n);case 2:i=e.sent,se(i),se(i,!0),oe(i),z(!1);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),oe=function(e){var n=e.conditions,i=e.fields,t=(e.id,[]);null===n||void 0===n||n.map((function(e){var n,l=i.find((function(n){return n.id==e.form_field_id}));console.log("fff",l);var r=null===(n=(null===l||void 0===l?void 0:l.basicDataItems)||(null===l||void 0===l?void 0:l.options))||void 0===n?void 0:n.map((function(e){return{id:e.id,label:e.label,server_id:e.id,value:e.option}}));console.log("fff",r);var a=t.findIndex((function(n){return n.field==e.form_field_id}));if(a>-1){var o,d,s=null===r||void 0===r?void 0:r.find((function(n){return n.id==(e.basic_data_item_id||e.form_field_option_id)}));console.log("p[topnnnnsss",r),console.log("p[topnnnnsss",s),console.log("p[topnnnnsss",e),null===(o=t[a])||void 0===o||null===(d=o.values)||void 0===d||d.push({id:null===s||void 0===s?void 0:s.id,label:null===s||void 0===s?void 0:s.label,server_id:null===s||void 0===s?void 0:s.id,value:null===s||void 0===s?void 0:s.value})}else{var c=null===r||void 0===r?void 0:r.find((function(n){return n.id==(e.basic_data_item_id||e.form_field_option_id)}));t.push({field:e.form_field_id,id:e.id,operation:1==e.operation?{name:"operation",value:"show"}:{name:"operation",value:"hide"},relationField:e.relational_form_field_id,saved:!0,values:[{id:null===c||void 0===c?void 0:c.id,label:null===c||void 0===c?void 0:c.label,server_id:null===c||void 0===c?void 0:c.id,value:null===c||void 0===c?void 0:c.value}]})}})),console.log("tmp123",[].concat(t)),M([].concat(t))},se=function(e,n){var i=[],t=n?e.relatedFields:e.fields;console.log("formId",e.id),null===t||void 0===t||t.forEach((function(n){var t,l,r,a,o,d,s,c,u,f,v;console.log("item",n);var p={id:n.id,name:n.name,type:null===(t=n.type)||void 0===t?void 0:t.type,typeId:n.form_field_type_id,label:n.label,placeholder:n.placeholder,required:n.required,basic_data:n.basic_data,basic_data_id:(null===(l=n.basic_data)||void 0===l?void 0:l.id)||null,form:n.form&&(null===(r=n.form)||void 0===r?void 0:r.id)!=e.id?n.form:null,fromRelatedFields:!(null===(a=n.form)||void 0===a||!a.id||(null===(o=n.form)||void 0===o?void 0:o.id)==e.id),basicDataItems:(n.basicDataItems&&n.basicDataItems.length>0||(null===(d=n.type)||void 0===d?void 0:d.has_options))&&(null===(s=n.basicDataItems)||void 0===s?void 0:s.map((function(e){return{id:e.id,server_id:e.id,value:e.option,label:(0,x.jsx)("p",{children:e.label})}}))),options:(n.options&&n.options.length>0||(null===(c=n.type)||void 0===c?void 0:c.has_options))&&(null===(u=n.options)||void 0===u?void 0:u.map((function(e){return{id:e.id,server_id:e.id,value:e.option,label:(0,x.jsx)("p",{children:e.label})}}))),onlyImage:null===(f=JSON.parse(n.validation))||void 0===f?void 0:f.onlyImage,server_id:n.id,readOnly:null===(v=JSON.parse(n.validation))||void 0===v?void 0:v.readOnly};i.push(p)})),n?E(i):k(i)},ue=function(){var e=(0,r.Z)((0,l.Z)().mark((function e(n,i){var t,r,a,o,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===n||void 0===n?void 0:n.description,e.next=3,ie.Z.createForm({name:"form"+(null===K||void 0===K?void 0:K.id),product_id:null===K||void 0===K?void 0:K.product_id,product_steps:null===K||void 0===K||null===(t=K.id)||void 0===t?void 0:t.toString()});case 3:if(a=e.sent,W(a.id),"initialOrder"!==r||"m2"!==i){e.next=8;break}return e.next=8,ie.Z.updateForm(a.id,{conditions:[],fields:[{basic_data_id:null,form_field_type_id:null===b||void 0===b||null===(o=b.find((function(e){return"number"==e.type})))||void 0===o?void 0:o.id,helper_text:1,label:"\u0639\u0631\u0636",max:100,min:1,name:"width",order:0,origin_form_id:null,placeholder:"\u0639\u0631\u0636 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",required:!0,validation:'{"readOnly":true}'},{basic_data_id:null,form_field_type_id:null===b||void 0===b||null===(d=b.find((function(e){return"number"==e.type})))||void 0===d?void 0:d.id,helper_text:2,label:"\u0627\u0631\u062a\u0641\u0627\u0639",max:100,min:1,name:"height",order:1,origin_form_id:null,placeholder:"\u0627\u0631\u062a\u0641\u0627\u0639 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",required:!0,validation:'{"readOnly":true}'}],name:"form"+(null===K||void 0===K?void 0:K.id)});case 8:ae(a.id),z(!1);case 10:case"end":return e.stop()}}),e)})));return function(n,i){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.Z)((0,l.Z)().mark((function e(n,i){var t,r,o,d,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z(!0),t=(0,a.Z)(N),r=(0,a.Z)(L),console.log("pass",N),i&&(r=(0,a.Z)(i)),console.log("tmp",t),o=t.map((function(e){return e.name})),!((d=o.filter((function(e,n){return o.indexOf(e)!=n}))).length>0)){e.next=14;break}return s=t.filter((function(e){return d.includes(e.name)})),c=s.map((function(e){return e.label})),de.Z.error(ne("validations:fieldNamesMustBeUnique")+c),z(!1),e.abrupt("return");case 14:(u=ie.Z.updateForm(J,{name:"form"+(null===K||void 0===K?void 0:K.id),fields:t.map((function(e,n){var i,t,l={};return"uploadFile"===e.type&&(l.onlyImage=e.onlyImage),e.readOnly&&(l.readOnly=e.readOnly),{server_id:e.server_id,name:e.name,form_field_type_id:e.typeId,label:e.label,placeholder:e.placeholder,required:e.required,helper_text:e.id,validation:JSON.stringify(l),min:1,max:100,order:n,origin_form_id:e.fromRelatedFields?e.form.id:null,hasOptions:e.options&&e.options.length>0,basic_data:e.basic_data,basic_data_id:e.basic_data_id||null,basicDataItems:e.basicDataItems&&e.basicDataItems.length>0&&(null===(i=e.basicDataItems)||void 0===i?void 0:i.map((function(e){return{id:e.id,server_id:e.id,value:e.option,label:(0,x.jsx)("p",{children:e.label})}}))),options:e.options&&e.options.length>0&&(null===(t=e.options)||void 0===t?void 0:t.map((function(e){return{option:e.value,label:e.label.props.children,id:e.server_id}})))}})),conditions:r.map((function(e,n){var i,t;return{form_id:J,form_field_id:e.field,form_field_options_id:null===(i=e.values)||void 0===i?void 0:i.map((function(e){return e.id})),operation:"show"===(null===(t=e.operation)||void 0===t?void 0:t.value)?1:0,relational_form_field_id:e.relationField}}))})).then((function(e){console.log("updated!",e),se(e),oe(e),se(e,!0),z(!1),de.Z.success(ne("formSavedSuccessfully"))})),u.catch((function(e){z(!1),de.Z.error(ne("formSaveError"))}));case 17:case"end":return e.stop()}}),e)})));return function(n,i){return e.apply(this,arguments)}}();return(0,x.jsxs)("div",{className:"w-full h-full",children:[P&&(0,x.jsx)(Ze.Z,{}),(0,x.jsx)(p.Z,{handleBack:function(){te("/products/".concat(t,"/steps"))},actions:(0,x.jsxs)(x.Fragment,{children:[" ",(0,x.jsx)("div",{className:"w-[186px]",children:(0,x.jsx)(m.Z,{icon:(0,x.jsx)(s.Z,{}),text:ne("viewForm"),onClick:function(){},gray:!0})}),(0,x.jsx)("div",{className:"w-[138px] ms-4",children:(0,x.jsx)(m.Z,{icon:(0,x.jsx)(c.Z,{}),text:ne("saveForm"),onClick:fe})})]}),title:"".concat(ne("formBuilder")," ").concat(ne("step")," ").concat(null===K||void 0===K?void 0:K.step_name," ").concat(ne("product")," ").concat(null===K||void 0===K||null===(e=K.product)||void 0===e?void 0:e.name)}),(0,x.jsxs)("div",{className:"w-full flex",children:[(0,x.jsx)(ce,{handleChangeTab:_,selectedTab:j,addElement:function(e,n,i){var t={name:"input"+e+(Y+1).toString(),placeholder:e+(Y+1).toString(),label:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",type:e,typeId:n,required:!1,id:Y+1};if("dropDown"!==e&&"checkbox"!==e||(t=(0,o.Z)((0,o.Z)({},t),{},{options:[]})),"uploadFile"===e&&(t=(0,o.Z)((0,o.Z)({},t),{},{onlyImage:!1})),i){var l=S.find((function(e){return e.server_id==n}));l&&(t=(0,o.Z)((0,o.Z)({},l),{},{fromRelatedFields:i}))}k([].concat((0,a.Z)(N),[t])),ee(Y+1)},selectedField:q,handleUpdateField:function(e){var n=(0,a.Z)(N),i=n.findIndex((function(n){return n.id==e.id}));-1!==i&&(n[i]=(0,o.Z)({},e),k((0,a.Z)(n)),R((0,o.Z)({},e)))},handleAddOption:function(e,n){var i=(0,a.Z)(N),t=i.findIndex((function(n){return n.id==e}));if(-1!==t&&i[t].options){var l=i[t].options||[];i[t]=(0,o.Z)((0,o.Z)({},i[t]),{},{options:[].concat((0,a.Z)(l),[(0,o.Z)((0,o.Z)({},n),{},{id:Math.floor(100*Math.random())})])}),k((0,a.Z)(i)),R((0,o.Z)({},i[t]))}},handleUpdateOption:function(e,n,i){var t=(0,a.Z)(N),l=t.findIndex((function(n){return n.id==e}));if(-1!==l&&t[l].options){var r=t[l].options||[];r[i]=n,t[l]=(0,o.Z)((0,o.Z)({},t[l]),{},{options:(0,a.Z)(r)}),k((0,a.Z)(t)),R((0,o.Z)({},t[l]))}},handleDeleteOption:function(e,n,i){var t=(0,a.Z)(N),l=t.findIndex((function(n){return n.id==e}));if(-1!==l&&t[l].options){var r=(0,a.Z)(t[l].options||[]),d=r.findIndex((function(e){return e.value==n}));d>-1&&(r.splice(d,1),t[l]=(0,o.Z)((0,o.Z)({},t[l]),{},{options:(0,a.Z)(r)}),k((0,a.Z)(t)),R((0,o.Z)({},t[l])))}i&&ie.Z.deleteOption(i).then((function(e){}))},setOnlyImage:function(e){var n=(0,a.Z)(N),i=n.findIndex((function(e){return e.id==(null===q||void 0===q?void 0:q.id)}));i>-1&&(n[i]=(0,o.Z)((0,o.Z)({},n[i]),{},{onlyImage:e}),k((0,a.Z)(n)),R((0,o.Z)({},n[i])))},setRequired:function(e){var n=(0,a.Z)(N),i=n.findIndex((function(e){return e.id==(null===q||void 0===q?void 0:q.id)}));i>-1&&(n[i]=(0,o.Z)((0,o.Z)({},n[i]),{},{required:e}),k((0,a.Z)(n)),R((0,o.Z)({},n[i])))},formElements:N,saveConditions:function(e){M((0,a.Z)(e.filter((function(e){return e.saved})))),console.log("[...conditions.filter((x) => x.saved)]",(0,a.Z)(e.filter((function(e){return e.saved})))),fe(null,(0,a.Z)(e.filter((function(e){return e.saved}))))},savedConditions:L,setFromBasicData:function(e){var n=(0,a.Z)(N),i=n.findIndex((function(e){return e.id==(null===q||void 0===q?void 0:q.id)}));if(i>-1){var t,l=(null===(t=n[i].basic_data)||void 0===t?void 0:t.id)||(null===G||void 0===G?void 0:G[0].id);console.log("bas",l),n[i]=(0,o.Z)((0,o.Z)({},n[i]),{},{basic_data_id:1==e?l:null,basic_data:1==e?n[i].basic_data||(null===G||void 0===G?void 0:G[0]):null,basicDataItems:1==e?(n[i].basic_data||(null===G||void 0===G?void 0:G[0])).items.map((function(e){return{id:e.id,label:(0,x.jsx)("p",{children:e.name}),server_id:e.id,value:e.code}})):null}),k((0,a.Z)(n)),R((0,o.Z)({},n[i]))}},relatedFields:S}),(0,x.jsx)("div",{className:"basis-3/4 bg-white ms-2",children:(0,x.jsx)(xe,{lastId:Y,setLastId:ee,saveFormLoading:P,formElements:N,selectedField:q,setFormElements:k,handleSelectField:le,deleteItem:re})})]})]})}}}]);
//# sourceMappingURL=1535.afcbd3b2.chunk.js.map