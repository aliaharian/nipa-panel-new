"use strict";(self.webpackChunknipa_panel_new=self.webpackChunknipa_panel_new||[]).push([[5454],{979:(e,l,a)=>{a.d(l,{A:()=>n});var t=a(670),i=a(4978);const n={getForm:async function(e,l){var a;let n=await(null===(a=(0,t.A)())||void 0===a?void 0:a.get("/forms/".concat(e).concat(l?"?orderId="+l:""),{headers:{languege:i.Ay.language}}));return null===n||void 0===n?void 0:n.data},createForm:async function(e){var l;let a=await(null===(l=(0,t.A)())||void 0===l?void 0:l.post("/forms",{...e}));return null===a||void 0===a?void 0:a.data},getFormFieldTypes:async function(){var e;let l=await(null===(e=(0,t.A)())||void 0===e?void 0:e.get("/formFieldTypes",{headers:{languege:i.Ay.language}}));return null===l||void 0===l?void 0:l.data},createFormField:async function(e){var l;let a=await(null===(l=(0,t.A)())||void 0===l?void 0:l.post("/formFields",{...e}));return null===a||void 0===a?void 0:a.data},updateFormField:async function(e,l){var a;let i=await(null===(a=(0,t.A)())||void 0===a?void 0:a.put("/formFields/".concat(e),{...l}));return null===i||void 0===i?void 0:i.data},updateForm:async function(e,l){var a;let i=await(null===(a=(0,t.A)())||void 0===a?void 0:a.put("/forms/".concat(e),{...l}));return null===i||void 0===i?void 0:i.data},deleteOption:async function(e){var l;let a=await(null===(l=(0,t.A)())||void 0===l?void 0:l.delete("/formFieldOptions/".concat(e)));return null===a||void 0===a?void 0:a.data},deleteItem:async function(e,l){var a;let i=await(null===(a=(0,t.A)())||void 0===a?void 0:a.post("/formFields/".concat(e),{_method:"delete",form_id:l}));return null===i||void 0===i?void 0:i.data},addUserAnswer:async function(e,l,a){var i;let n=await(null===(i=(0,t.A)())||void 0===i?void 0:i.post("/userAnswer/".concat(l,"/answer"),{order_id:e,...a}));return null===n||void 0===n?void 0:n.data}}},1461:(e,l,a)=>{a.d(l,{dN:()=>v,rS:()=>p,Cw:()=>h});var t=a(9973),i=a(8962),n=a(2087),r=a(5043),s=a(8366),o=a(579);const d=e=>{var l,a,t;let{name:i,label:n,formik:d,placeholder:c,maskChar:u,className:m,mask:v,inputActions:p,options:h}=e;const[x,f]=(0,r.useState)([]);return(0,o.jsxs)("div",{className:"flex flex-col w-full items-start justify-start ".concat(m),children:[(0,o.jsxs)("div",{className:"text-sm mb-2 flex justify-between w-full",children:[(0,o.jsx)("label",{htmlFor:i,children:n}),null===p||void 0===p?void 0:p()]}),(0,o.jsx)("div",{className:"flex items-center justify-start max-w-full flex-wrap",children:null===h||void 0===h?void 0:h.map(((e,l)=>(0,o.jsx)(s.A,{className:"group",name:i,value:e.value,label:e.label,checked:x.includes(e.value)||!1,handleCheck:()=>(e=>{if(x.includes(e.value)){let l=[...x];const a=l.indexOf(e.value);-1!==a&&(l.splice(a,1),f([...l])),d.setFieldValue(i,[...l])}else f([...x,e.value]),d.setFieldValue(i,[...x,e.value])})(e)},l)))}),(null===(l=d.errors)||void 0===l?void 0:l[i])&&(null===(a=d.touched)||void 0===a?void 0:a[i])&&(0,o.jsx)("p",{className:"text-error-primary text-[10px] mt-1",children:null===(t=d.errors)||void 0===t?void 0:t[i]})]})};var c=a(3033),u=a(2280),m=a(2434);const v=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{},a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const s=a||{handleChange:()=>{},setFieldValue:()=>{},values:null};switch(e.type){case"text":return(0,o.jsx)(t.A,{className:"group",name:e.name,label:e.label,type:"text",placeholder:e.placeholder,inputActions:()=>l(e),formik:s});case"textArea":return(0,o.jsx)(i.A,{className:"group",name:e.name,label:e.label,inputActions:()=>l(e),formik:s});case"number":return(0,o.jsx)(t.A,{className:"group",name:e.name,label:e.label,type:"number",placeholder:e.placeholder,inputActions:()=>l(e),formik:s});case"uploadFile":return(0,o.jsx)(u.A,{className:"group",name:e.name,label:e.label,placeholder:e.placeholder,imageOnly:e.onlyImage,formik:s,setPending:e.setPending,mock:r||!1,noBadge:e.noBadge||!1});case"dropDown":return(0,o.jsx)(n.A,{className:"group",name:e.name,label:e.label,options:e.basicDataItems||e.options,placeholder:e.placeholder,inputActions:()=>l(e),formik:s});case"checkbox":return(0,o.jsx)(d,{className:"group",name:e.name,label:e.label,options:e.basicDataItems||e.options,placeholder:e.placeholder,inputActions:()=>l(e),formik:s});case"datePicker":return(0,o.jsx)(m.A,{className:"group",name:e.name,label:e.label,placeholder:e.placeholder,inputActions:()=>l(e),formik:s});default:return(0,o.jsx)("p",{children:"not defined"})}},p=e=>{let l={};return e.map((e=>{switch(e.type){case"text":case"textArea":l[e.name]=e.answer||"";break;case"uploadFile":case"dropDown":l[e.name]=e.answer||null;break;case"number":l[e.name]=e.answer||0;break;case"checkbox":l[e.name]=e.answer||[]}})),l},h=(e,l,a)=>{let t={};return e.map((i=>{const n=l.find((e=>e.relational_form_field_id==i.id));let r=!0;if(n){const l=e.find((e=>e.id==n.form_field_id));let t;var s,o,d,u;if(l)if(l.basic_data_id)t=null===l||void 0===l||null===(s=l.basicDataItems)||void 0===s?void 0:s.find((e=>e.id==n.basic_data_item_id));else t=null===l||void 0===l||null===(o=l.options)||void 0===o?void 0:o.find((e=>e.server_id==n.form_field_option_id));if(l&&t)if(1==n.operation)r=a.values[l.name]===t.value||(null===(d=a.values[l.name])||void 0===d?void 0:d.indexOf(t.value))>-1;else r=!(a.values[l.name]===t.value||(null===(u=a.values[l.name])||void 0===u?void 0:u.indexOf(t.value))>-1)}if(r)switch(i.type){case"text":case"textArea":t[i.name]=i.required?c.Yj().required("\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a"):c.Yj();break;case"uploadFile":i.required&&(t[i.name]=c.Yj().nullable().required("\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a"));break;case"dropDown":t[i.name]=c.Yj().nullable().required("\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a");break;case"number":t[i.name]=i.required?c.ai().required("\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a"):c.ai();break;case"checkbox":t[i.name]=i.required?c.YO().of(c.Yj()).min(1,"\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a").required("\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a"):c.YO().of(c.Yj()).nullable()}})),t}},8366:(e,l,a)=>{a.d(l,{A:()=>d});var t,i=a(5043);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var l=1;l<arguments.length;l++){var a=arguments[l];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},n.apply(this,arguments)}function r(e,l){let{title:a,titleId:r,...s}=e;return i.createElement("svg",n({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",ref:l,"aria-labelledby":r},s),a?i.createElement("title",{id:r},a):null,t||(t=i.createElement("path",{d:"m7.75 12 2.83 2.83 5.67-5.66",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}const s=i.forwardRef(r);a.p;var o=a(579);const d=e=>{let{name:l,label:a,value:t,className:i,checked:n,handleCheck:r}=e;return(0,o.jsxs)("div",{className:"flex me-4 mb-4 items-start justify-start relative cursor-pointer ".concat(i),onClick:r,children:[(0,o.jsx)("input",{type:"checkbox",checked:n,value:t,name:l,onChange:r,className:"absolute top-0 left-0 opacity-0"}),(0,o.jsx)("div",{className:"w-6 h-6  rounded-[4px] me-2\n      ".concat(n?"border-none bg-primary-main":"border border-text-400","\n      "),children:(0,o.jsx)(s,{className:"text-white"})}),(0,o.jsx)("p",{className:"text-[14px]",children:a})]})}},2434:(e,l,a)=>{a.d(l,{A:()=>p});var t=a(8631),i=a(8390),n=a(9579),r=a(6636),s=a(7835),o=a(2846),d=a(9870),c=a(5043),u=a(7578),m=a(4117),v=a(579);const p=e=>{var l;let{className:a,name:p,label:h,inputActions:x,placeholder:f,formik:b,disablePast:g,disabled:j}=e;const w=c.useRef(null),{t:y}=(0,m.Bd)("common");return console.log(b.values),(0,v.jsx)(i.$,{dateAdapter:r.Q,children:(0,v.jsxs)("div",{className:"flex flex-col w-full items-start justify-start ".concat(a),children:[(0,v.jsxs)("div",{className:"text-xs mb-2 flex justify-between w-full",children:[(0,v.jsx)("label",{className:"font-normal",htmlFor:p,children:h}),null===x||void 0===x?void 0:x()]}),(0,v.jsx)(n.$,{value:null===(l=b.values)||void 0===l?void 0:l[p],disablePast:g,disabled:j,onAccept:e=>{console.log("newValue",e),b.setFieldValue(p,e)},className:"w-full",timezone:"Asia/Tehran",inputRef:w,slots:{toolbar:e=>{var l;return(0,v.jsxs)("div",{className:"p-4 MuiPickersToolbar-root MuiPickersLayout-toolbar bg-primary-main text-white css-1eurbeq-MuiPickersToolbar-root-MuiDatePickerToolbar-root",children:[(0,v.jsx)("span",{className:"text-white text-[12px]",children:"\u062a\u0627\u0631\u06cc\u062e \u0645\u0648\u0631\u062f \u0646\u0638\u0631 \u062e\u0648\u062f \u0631\u0627 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"}),(0,v.jsx)("div",{className:"mt-2 MuiPickersToolbar-content css-15jcv2p-MuiPickersToolbar-content",children:(0,v.jsx)("h4",{className:"text-[30px] MuiTypography-root MuiTypography-h4 MuiTypography-alignCenter MuiDatePickerToolbar-title css-3jvy96-MuiTypography-root-MuiDatePickerToolbar-title",children:(null===(l=e.value)||void 0===l?void 0:l.toLocaleDateString("fa-IR",{month:"long",day:"numeric"}))||"\u0627\u0646\u062a\u062e\u0627\u0628 \u062a\u0627\u0631\u06cc\u062e"})})]})},textField:e=>{var l;return(0,v.jsx)(t.A,{...e,value:(null===(l=e.ownerState.value)||void 0===l?void 0:l.toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric"}))||""})},leftArrowIcon:()=>(0,v.jsx)(s.A,{style:{width:20,height:20}}),rightArrowIcon:()=>(0,v.jsx)(o.A,{style:{width:20,height:20}}),actionBar:e=>(0,v.jsxs)("div",{className:"[grid-column:1/4] [grid-row:3] py-4 border-t border-text-300 px-4 flex justify-between",children:[(0,v.jsx)("div",{className:"w-[80px]",children:(0,v.jsx)(u.A,{text:y("deleteDate"),onClick:()=>{e.onClear()},simple:!0,sm:!0,className:"!text-error-primary !text-sm"})}),(0,v.jsx)("div",{className:"w-[100px]",children:(0,v.jsx)(u.A,{sm:!0,text:"\u062a\u0627\u06cc\u06cc\u062f",onClick:()=>{e.onAccept()}})})]})},slotProps:{textField:{className:"rounded-[6px]",label:"",placeholder:f||"",classes:{root:"!cursor-pointer !border-solid !border !hover:border-primary-main !border-text-400 rounded-[6px] h-12 !outline-none !shadow-none"},InputProps:{classes:{root:" h-12 pe-2 !ps-2",input:"!cursor-pointer !text-xs !font-bold hover:!border-primary-main focus:!border-primary-main",notchedOutline:"!border-none !outline-none !shadow-none"},endAdornment:(0,v.jsx)("div",{className:"w-[20px] h-[20px]",children:(0,v.jsx)(d.A,{style:{width:20,height:20,color:"#757575"}})})},inputProps:{}},toolbar:{className:"bg-primary-main text-white"},calendarHeader:{className:"[&>*:nth-child(1)]:ms-0 w-full flex justify-between items-center"}}})]})})}},8962:(e,l,a)=>{a.d(l,{A:()=>r});var t=a(5043),i=a(6839),n=a(579);const r=e=>{var l,a,r,s;let{name:o,label:d,formik:c,className:u,inputActions:m}=e;const v=(0,t.useRef)(null);return(0,n.jsxs)("div",{className:"flex flex-col w-full items-start justify-start ".concat(u),children:[(0,n.jsxs)("div",{className:"text-sm mb-2 flex justify-between w-full",children:[(0,n.jsx)("label",{htmlFor:o,children:d}),null===m||void 0===m?void 0:m()]}),(0,n.jsx)(i.K,{onInit:(e,l)=>v.current=l,id:o,value:null===(l=c.values)||void 0===l?void 0:l[o],onEditorChange:e=>{c.handleChange({target:{name:o,value:e}})},apiKey:"ajj87dt2tkk9iay286x5uxdjdb685g4spq516y5lacgqlerz",init:{height:150,width:"100%",menubar:!1,toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}}),(null===(a=c.errors)||void 0===a?void 0:a[o])&&(null===(r=c.touched)||void 0===r?void 0:r[o])&&(0,n.jsx)("p",{className:"text-error-primary text-[10px] mt-1",children:null===(s=c.errors)||void 0===s?void 0:s[o]})]})}},2280:(e,l,a)=>{a.d(l,{A:()=>b});var t=a(5043),i=a(6525),n=a(3397),r=a(1234),s=a(9600),o=a(4117),d=a(6640),c=a(1637),u=a(579);const m=e=>{let{src:l,badge:a,handleDelete:i,handleFullscreen:m,handleViewImage:v,hashCode:p}=e;const[h,x]=(0,t.useState)(),[f,b]=(0,t.useState)(!1),{t:g}=(0,o.Bd)(["common","validations"]);return(0,t.useEffect)((()=>{if(l.hash_code){x("https://apidemo.nipaco.ir/api/v1/files/"+l.hash_code)}else d.Ay.fileToUrl(l).then((e=>{x(e)}))}),[]),(0,t.useEffect)((()=>{var e;b((null===l||void 0===l||null===(e=l.type)||void 0===e?void 0:e.search("image"))>-1)}),[l]),(0,u.jsx)("div",{className:"group/item w-full h-full rounded-[6px] overflow-hidden relative",children:(0,u.jsxs)("div",{className:"w-full h-full relative",children:[a&&f&&(0,u.jsx)("p",{className:"right-[8px] top-[8px] text-[10px] inline-block absolute py-[5px] px-[8px] bg-secondary-500 text-white rounded-[4px]",children:a}),f?(0,u.jsx)("img",{src:h,alt:"",className:"w-full h-full object-cover rounded-[6px]"}):(0,u.jsxs)("div",{className:"w-full h-full flex items-center justify-center flex-col text-primary-main",children:[(0,u.jsx)(n.A,{className:"w-8 h-8"}),(0,u.jsx)("p",{className:"mt-2",children:l.name})]}),(0,u.jsxs)("div",{className:"absolute top-0 left-0 bg-black-60 w-full h-full flex grid grid-rows-3 ".concat(p?"opacity-0":"opacity-100"," pointer-events-none group-hover/item:opacity-100 group-hover/item:pointer-events-auto transition-all"),children:[(0,u.jsx)("div",{}),(0,u.jsx)("div",{children:p?v&&(0,u.jsx)("p",{onClick:v,className:"cursor-pointer text-[10px] inline-block py-[5px] px-[8px] bg-secondary-500 text-white rounded-[4px]",children:g(f?"viewImage":"viewFile")}):(0,u.jsx)(c.A,{})}),(0,u.jsxs)("div",{className:"w-full flex items-center justify-between px-[10px] py-[12px] text-white",children:[p&&m&&(0,u.jsx)("div",{className:"cursor-pointer",onClick:m,children:f&&(0,u.jsx)(r.A,{})}),p&&i&&(0,u.jsx)("div",{className:"cursor-pointer",onClick:i,children:(0,u.jsx)(s.A,{})})]})]})]})})};var v=a(9218);const p=e=>{let{url:l}=e;return(0,u.jsxs)("div",{id:"image-fullscreen",className:"fixed w-[100vw] h-[100vh] bg-black-90 flex flex-col items-center justify-center left-0 top-0 z-[999]",children:[(0,u.jsx)("div",{className:"w-full h-[60px] px-16 pt-8 flex items-center text-white",children:(0,u.jsx)(v.A,{onClick:()=>{document.body.removeChild(document.getElementById("image-fullscreen"))},className:"w-[40px] h-[40px] cursor-pointer"})}),(0,u.jsx)("div",{className:"w-full h-[calc(100%-60px)] flex items-center justify-center pb-10",children:(0,u.jsx)("img",{src:l,className:"w-full max-w-[70vw] h-full object-contain",alt:""})})]})};var h=a(4391),x=a(670),f=a(5424);const b=e=>{var l,a,n,r,s;let{name:c,label:v,formik:b,placeholder:g,className:j,imageOnly:w,setPending:y,mock:A,noBadge:N}=e;const{t:k}=(0,o.Bd)(["common","validations"]),F=(0,t.useRef)(null),[C,_]=(0,t.useState)([]),[I,P]=(0,t.useState)(!1),T=async(e,l,a)=>{var t=new FormData;t.append("file",e);try{var i,n,r;let e=await(null===(i=(0,x.A)())||void 0===i?void 0:i.post("/files",t,{headers:{"Content-Type":"multipart/form-data"}}));if(null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&null!==(r=n.file)&&void 0!==r&&r.hash_code){const t=[...a],i=t.findIndex((e=>e.name===l));-1!==i&&(t[i]={...t[i],hashCode:e.data.file.hash_code},_([...t]))}P(!1)}catch(s){const e=[...a],t=e.findIndex((e=>e.name===l));-1!==t&&(e.splice(t,1),_([...e])),f.A.error(k("validations:uploadError")),P(!1)}};var D;((0,t.useEffect)((()=>{b.setFieldValue(c,C)}),[C]),(null===(l=b.values)||void 0===l||null===(a=l[c])||void 0===a?void 0:a.length)>0&&0==C.length)&&_((null===(D=b.values)||void 0===D?void 0:D[c])||[]);return(0,t.useEffect)((()=>{y&&y(I)}),[I]),(0,u.jsxs)("div",{className:"flex flex-col w-full items-start justify-start ".concat(j),children:[(0,u.jsx)("div",{className:"text-sm mb-2 flex justify-between w-full",children:(0,u.jsx)("label",{className:"font-normal",htmlFor:c,children:v})}),(0,u.jsxs)("div",{className:"bg-text-300 w-full p-[14px] grid grid-cols-5 gap-x-5 gap-y-5",children:[C.length<5&&(0,u.jsx)("div",{className:"bg-white w-full h-min rounded-[6px]",children:(0,u.jsx)(i.A,{disabled:I,name:"uploadFile",imageOnly:w,fileRef:F,placeholder:I?k("pleaseWait")||"":g||"",formik:{handleChange:e=>{A||((async e=>{const l=[...C],a=c+"_"+Math.floor(100*Math.random());l.push({name:a,value:e.target.value,hashCode:null}),_([...l]),P(!0),T(e.target.value,a,l)})(e),F.current&&(F.current.value=""))}}})}),C.map(((e,l)=>(0,u.jsx)("div",{className:"bg-white rounded-[6px] w-full h-[144px]",children:(0,u.jsx)(m,{src:(null===e||void 0===e?void 0:e.value)||(null===e||void 0===e?void 0:e.file),hashCode:e.hashCode,handleDelete:()=>{(async(e,l)=>{let a=[...C];try{var t;await(null===(t=(0,x.A)())||void 0===t?void 0:t.delete("/files/".concat(e.hashCode))),a.splice(l,1),_([...a]),f.A.success(k("validations:imageDeleteSuccess"))}catch(i){f.A.error(k("validations:imageDeleteError"))}})(e,l)},handleFullscreen:()=>{(e=>{d.Ay.imageValidExtensions.includes(e.type)&&d.Ay.fileToUrl(e).then((e=>{const l=document.createElement("div");l.setAttribute("id","image-fullscreen"),document.body.appendChild(l),h.createRoot(l).render((0,u.jsx)(p,{url:e}))}))})(e.value)},handleViewImage:()=>{(e=>{const l=d.Ay.fileToBlob(e),a=URL.createObjectURL(l);window.open(a,"_blank")})(e.value)},badge:0!==l||N?"":k("mainImage")||""})},l)))]}),(null===(n=b.errors)||void 0===n?void 0:n[c])&&(null===(r=b.touched)||void 0===r?void 0:r[c])&&(0,u.jsx)("p",{className:"text-error-primary text-[10px] mt-1",children:null===(s=b.errors)||void 0===s?void 0:s[c]})]})}}}]);
//# sourceMappingURL=5454.825fbd37.chunk.js.map