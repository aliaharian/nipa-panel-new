"use strict";(self.webpackChunknipa_panel_new=self.webpackChunknipa_panel_new||[]).push([[9473],{2199:(e,t,n)=>{n.d(t,{GQ:()=>m,Zk:()=>h,z6:()=>v,Hu:()=>d});var s=n(7097),o=n(3747),r=n(3248),i=n(670);async function a(){var e;let t=await(null===(e=(0,i.A)())||void 0===e?void 0:e.get("/profile"));return null===t||void 0===t?void 0:t.data}async function l(e){var t;let n=await(null===(t=(0,i.A)())||void 0===t?void 0:t.post("/completeProfile",e));return null===n||void 0===n?void 0:n.data}var u=n(7311),c=n(7417);const d=()=>{const e=(0,u.j)(),{mutate:t,isPending:n}=(0,s.n)({mutationKey:["sendOtp"],mutationFn:e=>async function(e){var t;let n=await(null===(t=(0,i.A)())||void 0===t?void 0:t.post("/sendOtp",{mobile:e.mobile}));return{...null===n||void 0===n?void 0:n.data,mobile:e.mobile}}(e),onSuccess:t=>{e((0,c.ex)(t.mobile))}});return{mutate:t,loading:n}},h=()=>{const e=(0,u.j)(),{mutate:t,isPending:n}=(0,s.n)({mutationKey:["confirmOtp"],mutationFn:e=>async function(e){var t;let n=await(null===(t=(0,i.A)())||void 0===t?void 0:t.post("/confirmOtp",{mobile:e.mobile,otp:e.otp}));return null===n||void 0===n?void 0:n.data}(e),onSuccess:t=>{e((0,c.PT)(t))}});return{mutate:t,loading:n}},v=()=>{const{data:e,isPending:t}=(0,o.I)({queryKey:["userInfo"],queryFn:a});return{data:e,isPending:t}},m=()=>{const e=(0,r.jE)(),{mutate:t,isPending:n}=(0,s.n)({mutationKey:["completeProfile"],mutationFn:l,onSuccess:t=>{e.setQueryData(["userInfo"],t)}});return{mutate:t,loading:n}}},6041:(e,t,n)=>{n.d(t,{J3:()=>r,WG:()=>i,hR:()=>o});const s=n(8852).A.actions,o=e=>async(t,n)=>{t(s.setApiLoading(e))},r=e=>async(t,n)=>{t(s.setCollapseMenu(e))},i=e=>async(t,n)=>{t(s.setOpenMenu(e))}},7311:(e,t,n)=>{n.d(t,{G:()=>r,j:()=>o});var s=n(9456);const o=()=>(0,s.wA)(),r=s.d4},7417:(e,t,n)=>{n.d(t,{gJ:()=>u,Up:()=>l,ug:()=>c,ri:()=>d,PT:()=>a,ex:()=>i});var s=n(670);const o={sendOtp:async function(e){var t;let n=await(null===(t=(0,s.A)())||void 0===t?void 0:t.post("/sendOtp",{mobile:e.mobile}));return null===n||void 0===n?void 0:n.data},confirmOtp:async function(e){var t;console.log("cscscsc",e);let n=await(null===(t=(0,s.A)())||void 0===t?void 0:t.post("/confirmOtp",{mobile:e.mobile,otp:e.otp}));return null===n||void 0===n?void 0:n.data},getRolesList:async function(){var e;let t=await(null===(e=(0,s.A)())||void 0===e?void 0:e.get("/roles"));return null===t||void 0===t?void 0:t.data},getUserInfo:async function(){var e;let t=await(null===(e=(0,s.A)())||void 0===e?void 0:e.get("/profile"));return null===t||void 0===t?void 0:t.data},getCustomersList:async function(){var e;let t=await(null===(e=(0,s.A)())||void 0===e?void 0:e.get("/customers"));return null===t||void 0===t?void 0:t.data}};const r=n(5730).A.actions,i=e=>async(t,n)=>{t(r.setUserMobile(e))},a=e=>async(t,n)=>{t(r.setUserLogin(e))},l=()=>async(e,t)=>{const n=await o.getRolesList();console.log(n),e(r.getRolesList(n))},u=()=>async(e,t)=>{const n=await o.getCustomersList();e(r.getCustomersList(n.customers))},c=()=>async(e,t)=>{const n=await o.getUserInfo();console.log(n),e(r.getUserInfo(n))},d=()=>async(e,t)=>{e(r.logout())}},670:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(7154),o=n(6041),r=n(6254),i=n(5424);const a=()=>{const e=s.A.create({baseURL:"https://apidemo.nipaco.ir/api/v1",headers:localStorage.getItem("nipa_token")?{"Content-Type":"application/json",Accept:"application/json",language:localStorage.getItem("nipa-lang")||"fa",authorization:"Bearer "+localStorage.getItem("nipa_token")}:{"Content-Type":"application/json",Accept:"application/json"}});return e.interceptors.request.use((function(e){return r.A.dispatch((0,o.hR)(!0)),e}),(function(e){return r.A.dispatch((0,o.hR)(!1)),Promise.reject(e)})),e.interceptors.response.use((function(e){return r.A.dispatch((0,o.hR)(!1)),e}),(function(e){if(e.response.status,403==e.response.status&&(document.location.href="/errors/403"),e.response.data.errors){Object.keys(e.response.data.errors).map((t=>e.response.data.errors[t])).forEach((e=>{i.A.error(e)}))}else console.log("err",e.response),i.A.error(e.response.data.message||e.response.data.msg||e.response.data.error);return r.A.dispatch((0,o.hR)(!1)),Promise.reject(e)})),e}},7578:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(1637),o=(n(5043),n(5475)),r=n(579);const i=e=>{let{type:t,simple:n,bordered:i,href:a,text:l,onClick:u,icon:c,after:d,sm:h,xs:v,gray:m,disabled:p,loading:x,className:f}=e;const g="w-full ".concat(f," ").concat(v?"h-[36px]":h?"h-[38px]":"h-12"," rounded-[8px] flex items-center justify-center bg-primary-main text-white ").concat(i?"border border-primary-main bg-transparent !text-primary-main":"","\n   ").concat(n?"border-none bg-transparent !text-primary-main":"","\n   ").concat(m?"border-none !bg-text-200 !text-text-500":"","\n    ").concat(p?"opacity-90 cursor-not-allowed pointer-events-none":"","\n  "),b=()=>c?(0,r.jsx)("div",{className:"inline-block me-1",children:c}):(0,r.jsx)(r.Fragment,{});return(0,r.jsxs)(r.Fragment,{children:[a&&(0,r.jsxs)(o.N_,{to:a,className:g,children:[!d&&b(),x?(0,r.jsx)(s.A,{className:"!text-white !w-[20px] !h-[20px]"}):l,d&&b()]}),t&&(0,r.jsxs)("button",{className:g,type:t,children:[!d&&b(),x?(0,r.jsx)(s.A,{className:"!text-white !w-[20px] !h-[20px]"}):l,d&&b()]}),u&&(0,r.jsxs)("button",{className:g,onClick:u,children:[!d&&b(),x?(0,r.jsx)(s.A,{className:"!text-white !w-[20px] !h-[20px]"}):l,d&&b()]})]})}},9473:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var s=n(3516),o=n(5043),r=n(3033),i=n(7578),a=n(7311),l=n(3216),u=n(579);const c=e=>{var t,n,s,r,i,a,l,c,d,h,v,m,p;let{name:x,formik:f}=e;const g=(0,o.useRef)(null),b=(0,o.useRef)(null),A=(0,o.useRef)(null),y=(0,o.useRef)(null),j=(0,o.useRef)(null);function w(e){var t,n;let s=[g,b,A,y,j];e.target.value=e.target.value;let o={v0:f.values[x].length>=1?f.values[x].slice(0,1):"",v1:f.values[x].length>=2?f.values[x].slice(1,2):"",v2:f.values[x].length>=3?f.values[x].slice(2,3):"",v3:f.values[x].length>=4?f.values[x].slice(3,4):"",v4:f.values[x].length>=5?f.values[x].slice(4,5):"",["v"+e.target.name]:e.target.value},r=Object.values(o).join("");f.handleChange({target:{name:x,value:r}}),r.length,e.target.name<4&&(null===(t=s[parseInt(e.target.name)+1])||void 0===t||null===(n=t.current)||void 0===n||n.focus())}return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"flex flex-row-reverse",children:[(0,u.jsx)("input",{className:"focus:border-primary-main !outline-none w-12 h-12 border border-text-400 rounded-[8px] flex items-center justify-center outline-none text-center mx-2 ".concat(null!==(t=f.errors)&&void 0!==t&&t[x]&&null!==(n=f.touched)&&void 0!==n&&n[x]?"!border-error-primary":""),name:"0",ref:g,value:f.values[x].length>=1?f.values[x].slice(0,1):"",placeholder:"-",onChange:w}),(0,u.jsx)("input",{className:"focus:border-primary-main !outline-none w-12 h-12 border border-text-400 rounded-[8px] flex items-center justify-center outline-none text-center mx-2 ".concat(null!==(s=f.errors)&&void 0!==s&&s[x]&&null!==(r=f.touched)&&void 0!==r&&r[x]?"!border-error-primary":""),name:"1",ref:b,value:f.values[x].length>=2?f.values[x].slice(1,2):"",placeholder:"-",onChange:w}),(0,u.jsx)("input",{className:"focus:border-primary-main !outline-none w-12 h-12 border border-text-400 rounded-[8px] flex items-center justify-center outline-none text-center mx-2 ".concat(null!==(i=f.errors)&&void 0!==i&&i[x]&&null!==(a=f.touched)&&void 0!==a&&a[x]?"!border-error-primary":""),name:"2",ref:A,value:f.values[x].length>=3?f.values[x].slice(2,3):"",placeholder:"-",onChange:w}),(0,u.jsx)("input",{className:"focus:border-primary-main !outline-none w-12 h-12 border border-text-400 rounded-[8px] flex items-center justify-center outline-none text-center mx-2 ".concat(null!==(l=f.errors)&&void 0!==l&&l[x]&&null!==(c=f.touched)&&void 0!==c&&c[x]?"!border-error-primary":""),name:"3",ref:y,value:f.values[x].length>=4?f.values[x].slice(3,4):"",placeholder:"-",onChange:w}),(0,u.jsx)("input",{className:"focus:border-primary-main !outline-none w-12 h-12 border border-text-400 rounded-[8px] flex items-center justify-center outline-none text-center mx-2 ".concat(null!==(d=f.errors)&&void 0!==d&&d[x]&&null!==(h=f.touched)&&void 0!==h&&h[x]?"!border-error-primary":""),name:"4",ref:j,value:f.values[x].length>=5?f.values[x].slice(4,5):"",placeholder:"-",onChange:w})]}),(null===(v=f.errors)||void 0===v?void 0:v[x])&&(null===(m=f.touched)||void 0===m?void 0:m[x])&&(0,u.jsx)("p",{className:"text-error-primary text-[10px] mt-1 text-start ps-2",children:null===(p=f.errors)||void 0===p?void 0:p[x]})]})};var d=n(2199);const h=r.Ik().shape({mobile:r.Yj().min(11,"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u0635\u062d\u06cc\u062d \u0646\u06cc\u0633\u062a").max(11,"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u0635\u062d\u06cc\u062d \u0646\u06cc\u0633\u062a ").required("\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u0627\u0644\u0632\u0627\u0645\u06cc \u0627\u0633\u062a"),otp:r.Yj().min(5,"\u06a9\u062f \u0635\u062d\u06cc\u062d \u0646\u06cc\u0633\u062a").max(5,"\u06a9\u062f \u0635\u062d\u06cc\u062d \u0646\u06cc\u0633\u062a ").required("\u06a9\u062f \u0627\u0644\u0632\u0627\u0645\u06cc \u0627\u0633\u062a")}),v=()=>{const e=(0,a.G)((e=>e.users.mobile)),t={mobile:e,otp:""},n=(0,l.Zp)(),{mutate:r,loading:v}=(0,d.Zk)(),m=(0,s.Wx)({initialValues:t,validationSchema:h,onSubmit:e=>{r(e,{onSuccess:e=>{(null===e||void 0===e?void 0:e.token)&&n("/dashboard",{replace:!0})}})}});return(0,o.useEffect)((()=>{!e&&n("/auth/login",{replace:!0})}),[e,n]),(0,u.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[(0,u.jsx)("h1",{className:"text-xl font-bold mb-7",children:"\u06a9\u062f \u062a\u0627\u06cc\u06cc\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"}),(0,u.jsxs)("p",{className:"text-text-500",children:["\u06a9\u062f \u06f5 \u0631\u0642\u0645\u06cc \u0628\u0647 \u0634\u0645\u0627\u0631\u0647 ",e," \u0627\u0631\u0633\u0627\u0644 \u0634\u062f."]}),(0,u.jsxs)("form",{onSubmit:m.handleSubmit,className:"w-full px-[80px]",children:[(0,u.jsx)("div",{className:"mt-7 w-full",children:(0,u.jsx)(c,{name:"otp",formik:m})}),(0,u.jsx)("div",{className:"mt-20",children:(0,u.jsx)(i.A,{text:"\u062a\u0627\u06cc\u06cc\u062f \u0648 \u062f\u0631\u06cc\u0627\u0641\u062a \u06a9\u062f",type:"submit",loading:v,disabled:v})})]})]})}},7097:(e,t,n)=>{n.d(t,{n:()=>w});var s,o,r,i,a,l=n(5043),u=n(9790),c=n(5149),d=n(8458),h=n(4181),v=n(4558),m=n(5239),p=n(1454),x=n(329),f=n(9723),g=(s=new WeakMap,o=new WeakMap,r=new WeakMap,i=new WeakMap,a=new WeakSet,class extends x.Q{constructor(e,t){super(),(0,u.A)(this,a),(0,c.A)(this,s,void 0),(0,c.A)(this,o,void 0),(0,c.A)(this,r,void 0),(0,c.A)(this,i,void 0),(0,v.A)(s,this,e),this.setOptions(t),this.bindMethods(),(0,h.A)(a,this,b).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var t;const n=this.options;this.options=(0,d.A)(s,this).defaultMutationOptions(e),(0,f.f8)(this.options,n)||(0,d.A)(s,this).getMutationCache().notify({type:"observerOptionsUpdated",mutation:(0,d.A)(r,this),observer:this}),null!==n&&void 0!==n&&n.mutationKey&&this.options.mutationKey&&(0,f.EN)(n.mutationKey)!==(0,f.EN)(this.options.mutationKey)?this.reset():"pending"===(null===(t=(0,d.A)(r,this))||void 0===t?void 0:t.state.status)&&(0,d.A)(r,this).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(null===(e=(0,d.A)(r,this))||void 0===e||e.removeObserver(this))}onMutationUpdate(e){(0,h.A)(a,this,b).call(this),(0,h.A)(a,this,A).call(this,e)}getCurrentResult(){return(0,d.A)(o,this)}reset(){var e;null===(e=(0,d.A)(r,this))||void 0===e||e.removeObserver(this),(0,v.A)(r,this,void 0),(0,h.A)(a,this,b).call(this),(0,h.A)(a,this,A).call(this)}mutate(e,t){var n;return(0,v.A)(i,this,t),null===(n=(0,d.A)(r,this))||void 0===n||n.removeObserver(this),(0,v.A)(r,this,(0,d.A)(s,this).getMutationCache().build((0,d.A)(s,this),this.options)),(0,d.A)(r,this).addObserver(this),(0,d.A)(r,this).execute(e)}});function b(){var e,t;const n=null!==(e=null===(t=(0,d.A)(r,this))||void 0===t?void 0:t.state)&&void 0!==e?e:(0,m.$)();(0,v.A)(o,this,{...n,isPending:"pending"===n.status,isSuccess:"success"===n.status,isError:"error"===n.status,isIdle:"idle"===n.status,mutate:this.mutate,reset:this.reset})}function A(e){p.j.batch((()=>{if((0,d.A)(i,this)&&this.hasListeners()){const h=(0,d.A)(o,this).variables,v=(0,d.A)(o,this).context;var t,n,s,r;if("success"===(null===e||void 0===e?void 0:e.type))null===(t=(n=(0,d.A)(i,this)).onSuccess)||void 0===t||t.call(n,e.data,h,v),null===(s=(r=(0,d.A)(i,this)).onSettled)||void 0===s||s.call(r,e.data,null,h,v);else if("error"===(null===e||void 0===e?void 0:e.type)){var a,l,u,c;null===(a=(l=(0,d.A)(i,this)).onError)||void 0===a||a.call(l,e.error,h,v),null===(u=(c=(0,d.A)(i,this)).onSettled)||void 0===u||u.call(c,void 0,e.error,h,v)}}this.listeners.forEach((e=>{e((0,d.A)(o,this))}))}))}var y=n(3248),j=n(3247);function w(e,t){const n=(0,y.jE)(t),[s]=l.useState((()=>new g(n,e)));l.useEffect((()=>{s.setOptions(e)}),[s,e]);const o=l.useSyncExternalStore(l.useCallback((e=>s.subscribe(p.j.batchCalls(e))),[s]),(()=>s.getCurrentResult()),(()=>s.getCurrentResult())),r=l.useCallback(((e,t)=>{s.mutate(e,t).catch(j.l)}),[s]);if(o.error&&(0,j.G)(s.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:r,mutateAsync:o.mutate}}}}]);
//# sourceMappingURL=9473.68860f2f.chunk.js.map