"use strict";(self.webpackChunknipa_panel_new=self.webpackChunknipa_panel_new||[]).push([[6313],{7625:(e,l,t)=>{t.d(l,{I:()=>d});var i=t(3161);const a=t(5700).A.actions,d=()=>async(e,l)=>{const t=await i.A.basicDatasList();e(a.basicDatasList(t))}},3161:(e,l,t)=>{t.d(l,{A:()=>a});var i=t(670);const a={basicDatasList:async function(){var e;let l=await(null===(e=(0,i.A)())||void 0===e?void 0:e.get("/basicData"));return null===l||void 0===l?void 0:l.data},getBasicDataInfo:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.get("/basicData/"+e));return null===t||void 0===t?void 0:t.data},addBasicDataItem:async function(e,l){var t;let a=await(null===(t=(0,i.A)())||void 0===t?void 0:t.post("/basicData/"+e+"/addItem",l));return null===a||void 0===a?void 0:a.data},changeBasicDataItemState:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.post("/basicData/item/"+e+"/updateStatus"));return null===t||void 0===t?void 0:t.data},deleteBasicDataItem:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.delete("/basicData/item/"+e));return null===t||void 0===t?void 0:t.data},editBasicDataItem:async function(e,l){var t;let a=await(null===(t=(0,i.A)())||void 0===t?void 0:t.put("/basicData/item/"+e,l));return null===a||void 0===a?void 0:a.data},addBasicData:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.post("/basicData",e));return null===t||void 0===t?void 0:t.data},deleteBasicData:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.delete("/basicData/"+e));return null===t||void 0===t?void 0:t.data}}},7311:(e,l,t)=>{t.d(l,{G:()=>d,j:()=>a});var i=t(9456);const a=()=>(0,i.wA)(),d=i.d4},7099:(e,l,t)=>{t.d(l,{DD:()=>u,JK:()=>d,Jm:()=>c,Nb:()=>n,Tu:()=>s,cz:()=>o,vc:()=>r,x7:()=>p});var i=t(8875);const a=t(8870).A.actions,d=()=>async(e,l)=>{const t=await i.A.productsList();e(a.productsList(t))},n=e=>async(l,t)=>{const d=await i.A.productStepsList(e);l(a.productStepsList(d))},o=e=>async(l,t)=>{if(0===e)return l(a.productStepInfo(null));const d=await i.A.productStepInfo(e);l(a.productStepInfo(d))},s=e=>async(l,t)=>{const d=await i.A.saveProduct(e);l(a.saveProduct(d))},r=(e,l)=>async(t,n)=>{const o=await i.A.updateProduct(e,l);t(a.updateProduct(o)),t(d())},c=e=>async(l,t)=>{l(a.setSaveSuccess(e))},u=e=>async(l,t)=>{const d=await i.A.deleteProduct(e);l(a.deleteProduct(d))},p=e=>async(l,t)=>{l(a.setDeleteSuccess(e))}},8875:(e,l,t)=>{t.d(l,{A:()=>a});var i=t(670);const a={productsList:async function(){var e;let l=await(null===(e=(0,i.A)())||void 0===e?void 0:e.get("/products"));return null===l||void 0===l?void 0:l.data},saveProduct:async function(e){var l,t;let a=await(null===(l=(0,i.A)())||void 0===l?void 0:l.post("/products",{name:e.name,code:e.code,custom:e.custom,price:e.price,count_type:e.count_type,status:e.status,description:e.description,images:null===(t=e.images)||void 0===t?void 0:t.map((e=>e.hashCode))}));return null===a||void 0===a?void 0:a.data},deleteProduct:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.delete("/products/".concat(e)));return null===t||void 0===t?void 0:t.data},productStepsList:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.get("/product/".concat(e,"/steps")));return null===t||void 0===t?void 0:t.data},productStepInfo:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.get("/productSteps/".concat(e)));return null===t||void 0===t?void 0:t.data},setProductStepRoles:async function(e,l){var t;let a=await(null===(t=(0,i.A)())||void 0===t?void 0:t.post("/product/steps/".concat(e,"/setRoles"),{roles:l.join(",")}));return null===a||void 0===a?void 0:a.data},addProductConditions:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.post("/product/steps/conditions",{step_id:e.stepId,field_id:e.fieldId,option_id:e.optionId,next_step_id:e.nextStepId}));return null===t||void 0===t?void 0:t.data},getProduct:async function(e){var l;let t=await(null===(l=(0,i.A)())||void 0===l?void 0:l.get("/products/".concat(e)));return null===t||void 0===t?void 0:t.data},updateProduct:async function(e,l){var t,a;let d=await(null===(t=(0,i.A)())||void 0===t?void 0:t.put("/products/".concat(e),{name:l.name,code:l.code,custom:l.custom,count_type:l.count_type,price:l.price,status:l.status,description:l.description,images:null===(a=l.images)||void 0===a?void 0:a.map((e=>e.hashCode))}));return null===d||void 0===d?void 0:d.data}}},1968:(e,l,t)=>{t.d(l,{A:()=>r});var i=t(9218),a=t(5043),d=t(579);const n=e=>{let{children:l}=e;return(0,d.jsx)("div",{className:"h-[calc(100%-97px)] overflow-auto",children:l})},o=e=>{let{children:l}=e;return(0,d.jsx)("div",{children:l})},s=e=>{let{open:l,handleClose:t,children:s,headerIcon:r,headerText:c=""}=e;const[u,p]=(0,a.useState)(Math.floor(1e3*Math.random()));return(0,d.jsx)("div",{id:"dialog".concat(u),onClick:e=>{e.target.id==="dialog"+u&&(null===t||void 0===t||t())},className:"w-full h-full fixed bg-black-60 rtl:left-0 ltr:right-0 top-0 transition-all ".concat(l?"opacity-1 z-[999] delay-200":"pointer-events-none opacity-0 z-0 delay-300"),children:(0,d.jsxs)("div",{className:"h-full w-[60%] min-w-[900px] bg-white transition-all\t".concat(l?"translate-x-0 delay-300":"ltr:-translate-x-[100%] rtl:translate-x-[100%] delay-200"),children:[c&&(0,d.jsxs)("div",{className:"flex w-full px-8 py-6 items-center justify-between border-b border-text-300",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"me-3 w-9 h-9 rounded-[12px] bg-primary-main flex items-center justify-center text-white",children:r}),(0,d.jsx)("p",{className:"text-[20px] leading-[20px] font-bold",children:c})]}),(0,d.jsx)("div",{className:"w-9 h-9",children:(0,d.jsx)("button",{onClick:t,className:"w-9 h-9",children:(0,d.jsx)(i.A,{className:"w-9 h-9"})})})]}),(0,d.jsx)("div",{className:"flex justify-between w-full flex-col h-[calc(100%-85px)]",children:a.Children.map(s,(e=>e.type===n?(0,d.jsx)(n,{children:e.props.children}):e.type===o?(0,d.jsx)(o,{children:e.props.children}):void 0))})]})})};s.Content=n,s.Footer=o;const r=s},6313:(e,l,t)=>{t.r(l),t.d(l,{default:()=>ce});var i=t(3447),a=t(6809),d=t(5043),n=t(6041),o=t(7311),s=t(3232),r=t(7578),c=t(579);const u=e=>{let{items:l,value:t,handleChange:i}=e;return(0,c.jsx)("div",{className:"mx-auto w-full flex px-3 items-center justify-between border-b mb-[19px] border-text-300",children:l.map(((e,l)=>(0,c.jsxs)("div",{className:"mx-1 cursor-pointer min-w-[70px] w-1/3 px-[10px] 2xl:px-[6px] relative flex items-center justify-center",onClick:()=>i(e.value),children:[(0,c.jsx)("p",{className:"mb-[20px] transition-all text-[14px] 2xl:text-[12px] leading-[20px] ".concat(e.value===t?"text-primary-main font-black 2xl:font-semibold":"text-text-500"),children:e.label}),(0,c.jsx)("div",{className:"w-full ".concat(e.value===t?"h-[3px] rounded-t-[2px]":"h-0"," bg-primary-main transition-all absolute bottom-0")})]},l)))})};var p=t(1128),v=t(9600),m=t(6421);const x=e=>{let{checked:l,setChecked:t}=e;return(0,c.jsx)("div",{onClick:()=>{t(!l)},className:"w-[36px] h-[20px] rounded-[10px] border ".concat(l?"border-primary-main":"border-text-500"," flex items-center ").concat(l?"justify-start":"justify-end"," p-[2px] cursor-pointer"),children:(0,c.jsx)("div",{className:"w-4 h-4 ".concat(l?"bg-primary-main":"bg-text-500"," rounded-full")})})},f=e=>{let{checked:l,setChecked:t,label:i}=e;return(0,c.jsxs)("div",{className:"w-full p-[8px] h-[48px] flex items-center justify-between border border-text-400 rounded-[8px] transition-al",children:[(0,c.jsx)("p",{className:"cursor-pointer text-text-800 text-[14px]",onClick:()=>t(!l),children:i}),(0,c.jsx)(x,{checked:l,setChecked:t})]})};var h=t(9973),b=t(1968),g=t(3516);const j=e=>{let{open:l,handleClose:t,field:i,handleAddOption:a,selectedOption:n}=e;const o={index:(null===n||void 0===n?void 0:n.index)||-1,id:(null===n||void 0===n?void 0:n.index)||0,fieldName:(null===n||void 0===n?void 0:n.label)||"",fieldValue:(null===n||void 0===n?void 0:n.value)||"",server_id:null===n||void 0===n?void 0:n.server_id},s=(0,g.Wx)({initialValues:o,onSubmit:e=>{console.log("values",e),a(e),s.setFieldValue("fieldName",""),s.setFieldValue("fieldValue",""),s.setFieldValue("index",-1),s.setFieldValue("server_id",-1),null===t||void 0===t||t()}});(0,d.useEffect)((()=>{n&&(s.setFieldValue("fieldName",n.label),s.setFieldValue("fieldValue",n.value),s.setFieldValue("index",n.index),s.setFieldValue("id",n.id),s.setFieldValue("server_id",n.server_id))}),[n]);const u=()=>{null===t||void 0===t||t(),s.setFieldValue("fieldName",""),s.setFieldValue("fieldValue",""),s.setFieldValue("index",-1)};return(0,c.jsxs)(b.A,{headerText:"".concat(n?"\u0648\u06cc\u0631\u0627\u06cc\u0634":"\u0627\u0641\u0632\u0648\u062f\u0646"," ").concat(i.label),headerIcon:(0,c.jsx)(m.A,{}),open:l,handleClose:u,children:[(0,c.jsx)(b.A.Content,{children:(0,c.jsx)("div",{className:"p-7",children:(0,c.jsx)("form",{onSubmit:s.handleSubmit,className:"w-full",children:(0,c.jsxs)("div",{className:"mt-7 w-full grid grid-cols-1 gap-x-5 gap-y-7",children:[(0,c.jsx)(h.A,{name:"fieldName",label:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u0646\u0645\u0627\u06cc\u06cc\u062f",formik:s}),(0,c.jsx)(h.A,{name:"fieldValue",label:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u0646\u0645\u0627\u06cc\u06cc\u062f",formik:s})]})})})}),(0,c.jsx)(b.A.Footer,{children:(0,c.jsxs)("div",{className:"mt-20 px-7 flex justify-between items-center py-[25px] border border-text-300",children:[(0,c.jsx)("div",{className:"w-[126px]",children:(0,c.jsx)(r.A,{text:"\u0627\u0646\u0635\u0631\u0627\u0641",onClick:u,gray:!0})}),(0,c.jsx)("div",{className:"w-[182px]",children:(0,c.jsx)(r.A,{text:"".concat(n?"\u0648\u06cc\u0631\u0627\u06cc\u0634":"\u0627\u0641\u0632\u0648\u062f\u0646"," ").concat(i.label),onClick:()=>{s.submitForm()}})})]})})]})};var y=t(4117),w=t(2087),_=t(7625);const A=e=>{let{selectedField:l,_handleUpdateField:t}=e;return(0,c.jsx)(w.A,{className:"group mb-[30px]",name:"width",label:"\u0639\u0631\u0636",options:["25","50","75","100"].map((e=>({label:(0,c.jsxs)("p",{children:[e,"%"]}),value:e.toString()}))),placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:e=>t(e),values:{width:l.width.toString()}}})},N=e=>{var l;let{selectedField:t,handleUpdateField:i,handleAddOption:a,handleDeleteOption:n,handleUpdateOption:s,onlyImage:u,setOnlyImage:x,required:b,setRequired:g,fromBasicData:N,setFromBasicData:F}=e;const[I,C]=(0,d.useState)(!1),[k,S]=(0,d.useState)(),D=(0,o.G)((e=>e.basicData.basicDatas)),{t:O}=(0,y.Bd)(),E=(0,o.j)();console.log("selected",t);const B=e=>{if(t){let l={...t};if("basic_data"==e.target.name){let t=null===D||void 0===D?void 0:D.find((l=>l.id==e.target.value));console.log("basicDataTmp",t),t&&(l={...l,[e.target.name]:t,basic_data_id:null===t||void 0===t?void 0:t.id,basicDataItems:t.items.map((e=>({id:e.id,label:(0,c.jsx)("p",{children:e.name}),server_id:e.id,value:e.code})))},i({...l}))}else l={...l,[e.target.name]:e.target.value},i({...l})}};(0,d.useEffect)((()=>{!D&&E((0,_.I)())}),[]);const V=e=>{var l;(console.log("ite",e),null!==e&&void 0!==e&&e.label)&&S({index:null===t||void 0===t||null===(l=t.options)||void 0===l?void 0:l.findIndex((l=>l.value===e.value)),value:e.value,label:e.label.props.children,id:e.id,server_id:e.server_id});t&&null!==t&&void 0!==t&&t.options&&C(!0)};return(0,c.jsx)("div",{children:(0,c.jsx)("div",{className:"w-full flex flex-col items-start justify-start px-4",children:t?t.fromRelatedFields||t.readOnly?(0,c.jsx)(A,{selectedField:t,_handleUpdateField:B}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("p",{className:"text-text-450 mb-[20px]",children:["\u0646\u0648\u0639 \u0641\u06cc\u0644\u062f: ",t.type]}),(0,c.jsx)(A,{selectedField:t,_handleUpdateField:B}),(0,c.jsx)(h.A,{className:"mb-[30px]",name:"label",label:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",formik:{handleChange:e=>B(e),values:{label:t.label}}}),(0,c.jsx)(h.A,{className:"mb-[30px]",name:"name",label:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f",type:"text",placeholder:"\u0646\u0627\u0645\u06a9 \u0641\u06cc\u0644\u062f",formik:{handleChange:e=>B(e),values:{name:t.name}}}),(0,c.jsx)(h.A,{className:"group",name:"placeholder",label:"\u0645\u062a\u0646 \u062c\u0627\u06cc\u06af\u0632\u06cc\u0646",type:"text",placeholder:"\u0645\u062a\u0646 \u062c\u0627\u06cc\u06af\u0632\u06cc\u0646",formik:{handleChange:e=>B(e),values:{placeholder:t.placeholder}}}),(0,c.jsx)("div",{className:"w-full mt-[30px]",children:(0,c.jsx)(f,{checked:b,setChecked:g,label:"\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f"})}),t.options?(0,c.jsx)("div",{className:"w-full mt-[30px]",children:(0,c.jsx)(f,{checked:N,setChecked:F,label:O("fromBasicDatas")||""})}):"",t.options&&N?(0,c.jsx)(w.A,{className:"group mt-[30px]",name:"basic_data",label:"\u062f\u0627\u062f\u0647 \u0627\u0648\u0644\u06cc\u0647",options:D?D.map((e=>({label:(0,c.jsx)("p",{children:e.name}),value:e.id.toString()}))):[],placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:e=>B(e),values:{basic_data:null===(l=t.basic_data)||void 0===l?void 0:l.id.toString()}}}):"","uploadFile"===t.type&&(0,c.jsx)("div",{className:"w-full mt-[30px]",children:(0,c.jsx)(f,{checked:u,setChecked:x,label:O("onlyImage")||""})}),t.options&&!N?(0,c.jsx)(j,{open:I,handleClose:()=>{S(void 0),C(!1)},field:t,handleAddOption:(e,l)=>{t&&(void 0!==e.index&&-1!==e.index?s(t.id,{label:(0,c.jsx)("p",{children:e.fieldName}),value:e.fieldValue.toString(),id:e.id,server_id:e.server_id},e.index):a(t.id,{label:(0,c.jsx)("p",{children:e.fieldName}),value:e.fieldValue.toString()}))},selectedOption:k}):"",t.options&&!N?(0,c.jsxs)("div",{className:"w-full mt-[25px]",children:[t.options.map(((e,l)=>(0,c.jsxs)("div",{className:"mb-[10px] h-14 text-[14px] font-semibold flex items-center rounded-[8px] px-[18px] justify-between bg-text-250",children:[(0,c.jsx)("p",{children:e.label}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("div",{onClick:()=>V(e),className:"w-[24px] h-[24px] me-1 cursor-pointer hover:bg-text-300 flex items-center justify-center rounded-[4px]",children:(0,c.jsx)(p.A,{className:"w-[20px] h-[20px]"})}),(0,c.jsx)("div",{onClick:()=>(e=>{t&&n(t.id,e.value,e.server_id)})(e),className:"w-[24px] h-[24px] ms-1 cursor-pointer hover:bg-text-300 flex items-center justify-center rounded-[4px]",children:(0,c.jsx)(v.A,{className:"w-[20px] h-[20px]"})})]})]},l))),(0,c.jsx)("div",{className:"w-full flex items-center justify-end",children:(0,c.jsx)("div",{className:"w-[111px] mt-[30px] float-left",children:(0,c.jsx)(r.A,{icon:(0,c.jsx)(m.A,{}),text:"\u0627\u0641\u0632\u0648\u062f\u0646",onClick:V})})})]}):""]}):(0,c.jsx)("p",{children:"\u0644\u0637\u0641\u0627 \u06cc\u06a9 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0628\u0631\u0627\u06cc \u0648\u06cc\u0631\u0627\u06cc\u0634 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"})})})};var F=t(9682),I=t(6635),C=t(8614);const k=e=>{let{icon:l,label:t,onClick:i,type:a,id:d}=e;return(0,c.jsxs)("div",{onClick:()=>i(a,d),className:"w-full h-[80px] flex flex-col items-center justify-center bg-text-200 rounded-[6px] cursor-pointer",children:[(0,c.jsx)("div",{children:l}),(0,c.jsx)("p",{className:"text-[12px] mt-[10px] text-text-700 font-medium",children:t})]})};var S;function D(){return D=Object.assign?Object.assign.bind():function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},D.apply(this,arguments)}function O(e,l){let{title:t,titleId:i,...a}=e;return d.createElement("svg",D({width:26,height:26,viewBox:"0 0 26 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l,"aria-labelledby":i},a),t?d.createElement("title",{id:i},t):null,S||(S=d.createElement("path",{d:"M8.666 8.666H13M8.666 17.332H13M8.666 13h8.667M9.75 23.833h6.5c5.416 0 7.583-2.167 7.583-7.584v-6.5c0-5.416-2.166-7.583-7.583-7.583h-6.5c-5.417 0-7.583 2.167-7.583 7.583v6.5c0 5.417 2.166 7.584 7.583 7.584z",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}const E=d.forwardRef(O);t.p;var B,V;function L(){return L=Object.assign?Object.assign.bind():function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},L.apply(this,arguments)}function R(e,l){let{title:t,titleId:i,...a}=e;return d.createElement("svg",L({width:39,height:24,viewBox:"0 0 39 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l,"aria-labelledby":i},a),t?d.createElement("title",{id:i},t):null,B||(B=d.createElement("path",{d:"M14.027 23h11.165c9.305 0 13.028-2.2 13.028-7.7V8.7c0-5.5-3.723-7.7-13.028-7.7H14.027C4.722 1 1 3.2 1 8.7v6.6C1 20.8 4.722 23 14.027 23z",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),V||(V=d.createElement("path",{d:"M7.62 14.227c0-.344-.002-.693-.007-1.045a22.997 22.997 0 0 0-.031-1.049c-.016-.346-.04-.687-.07-1.02a10.488 10.488 0 0 0-.134-.96 7.31 7.31 0 0 0-.207-.868 4.177 4.177 0 0 0-.305-.744l.998-.622c.135.211.249.433.34.665.091.233.167.474.227.724.063.248.113.504.153.767.041.261.08.527.117.799.026.208.047.434.063.676.015.243.027.49.035.74.01.25.017.498.02.744l.003.688v.505H7.621zM21.026 8.013c.03.188.051.36.067.517.016.156.023.3.023.434 0 .248-.036.493-.109.736-.073.24-.183.456-.329.65-.143.19-.323.345-.54.465a1.56 1.56 0 0 1-.755.176c-.068 0-.134-.001-.2-.004a2.127 2.127 0 0 1-.183-.024 23.971 23.971 0 0 1 .11 1.71c.007.29.01.574.01.854.003.279.005.54.005.786h-1.201c0-.438-.006-.88-.016-1.323a20.168 20.168 0 0 0-.063-1.287 12.676 12.676 0 0 0-.14-1.174 5.868 5.868 0 0 0-.251-.994l-.114-.274a3.357 3.357 0 0 0-.176-.387 4.952 4.952 0 0 0-.101-.192l1.01-.642a3.706 3.706 0 0 1 .25.458c.036.073.073.154.11.243l.124.297c.047.11.096.212.145.305.052.094.111.175.176.243a.764.764 0 0 0 .22.16.665.665 0 0 0 .285.051.48.48 0 0 0 .31-.094.498.498 0 0 0 .156-.223.923.923 0 0 0 .055-.3 7.02 7.02 0 0 0 .007-.326c0-.099-.006-.195-.02-.29a6.779 6.779 0 0 0-.046-.34l1.181-.211zM33.377 8.005l.078.43c.02.118.036.222.047.314a3.253 3.253 0 0 1 .035.47c0 .2-.026.4-.078.598a1.652 1.652 0 0 1-.247.536 1.3 1.3 0 0 1-.422.383c-.17.1-.372.15-.607.15a1.387 1.387 0 0 1-.693-.176 1.2 1.2 0 0 1-.23-.177c-.134.144-.28.25-.439.32a1.412 1.412 0 0 1-.563.103h-.145a1.181 1.181 0 0 1-.133-.016c.029.245.052.511.07.798.019.287.032.58.04.877.01.297.017.592.02.884.004.29.007.56.007.81h-1.213a11.068 11.068 0 0 0 .012-.47c.002-.09.004-.178.004-.262a7.2 7.2 0 0 0 .003-.207 23.603 23.603 0 0 0-.05-1.518c-.021-.272-.051-.546-.09-.822a8.511 8.511 0 0 0-.15-.818 6.242 6.242 0 0 0-.226-.779c-.091-.25-.2-.486-.325-.708l1.068-.622a3.06 3.06 0 0 1 .215.391c.04.076.081.163.126.263.044.096.095.21.152.34.058.133.106.243.145.329.042.083.084.15.125.2.042.049.09.084.141.105.053.018.12.027.204.027a.268.268 0 0 0 .176-.055.362.362 0 0 0 .11-.144.745.745 0 0 0 .058-.216c.01-.08.016-.164.016-.25 0-.096-.005-.2-.016-.31l-.039-.406 1.104-.157.027.263c.01.099.023.203.039.313.016.107.035.214.059.32.023.107.052.203.086.286.036.084.08.151.129.204.05.052.108.078.176.078a.147.147 0 0 0 .114-.047.362.362 0 0 0 .066-.121.75.75 0 0 0 .031-.153 1.05 1.05 0 0 0 .008-.266 2.124 2.124 0 0 0-.02-.168l-.042-.27a29.256 29.256 0 0 0-.075-.43l1.111-.224z",fill:"#303030"})))}const q=d.forwardRef(R);t.p;var M,P;function T(){return T=Object.assign?Object.assign.bind():function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},T.apply(this,arguments)}function U(e,l){let{title:t,titleId:i,...a}=e;return d.createElement("svg",T({width:39,height:24,viewBox:"0 0 39 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l,"aria-labelledby":i},a),t?d.createElement("title",{id:i},t):null,M||(M=d.createElement("path",{d:"M14.027 23h11.165c9.305 0 13.028-2.2 13.028-7.7V8.7c0-5.5-3.723-7.7-13.028-7.7H14.027C4.722 1 1 3.2 1 8.7v6.6C1 20.8 4.722 23 14.027 23z",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),P||(P=d.createElement("path",{d:"m6 10.065 3.883 3.872 3.883-3.872",stroke:"#303030",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}const z=d.forwardRef(U);t.p;var J=t(5577),G=t(979);const H=J.A.actions;var W=t(8185),K=t(7967);const Z=e=>{let{addElement:l,relatedFields:t}=e;const{t:i}=(0,y.Bd)(),a=(0,o.G)((e=>e.forms.formFieldTypes)),n=(0,o.j)();(0,d.useEffect)((()=>{a||n((async(e,l)=>{const t=await G.A.getFormFieldTypes();e(H.getFormFieldTypes(t))}))}),[]);const s=e=>{switch(e){case"TextBlock":default:return(0,c.jsx)(F.A,{});case"Frame":return(0,c.jsx)(E,{});case"NumericField":return(0,c.jsx)(q,{});case"ExportCurve":return(0,c.jsx)(I.A,{});case"Dropdown":return(0,c.jsx)(z,{});case"TickSquare":return(0,c.jsx)(C.A,{});case"DatePicker":return(0,c.jsx)(K.A,{})}};return(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"grid grid-cols-3 gap-[10px] px-4",children:a?a.map(((e,t)=>(0,c.jsx)(k,{id:e.id,type:e.type,onClick:l,icon:s(e.icon),label:e.label},e.id))):(0,c.jsx)(c.Fragment,{children:Array.from(Array(9).keys()).map(((e,l)=>(0,c.jsx)(W.A,{variant:"rounded",width:80,height:80,animation:"wave"},l)))})}),(0,c.jsx)("div",{className:"px-4",children:t?(0,c.jsx)(w.A,{className:"group mt-[30px]",name:"relatedFields",label:i("selectFromRelatedFields"),options:t?t.map((e=>{var l,t,a;return{label:(0,c.jsxs)("p",{children:[e.label," ",i("fromStep")," ",null===(l=e.form)||void 0===l||null===(t=l.step)||void 0===t?void 0:t.step_name]}),value:null===(a=e.server_id)||void 0===a?void 0:a.toString(),type:e.type}})):[],placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:e=>{console.log("e",e),l(e.target.type,e.target.value,!0)},values:{relatedFields:0}}}):""})]})};var Q=t(1906);const X=e=>{var l;let{conditionalfields:t,formElements:i,condition:n,setCondition:o,deleteCondition:s,saveCondition:r}=e;const[u,p]=(0,d.useState)(),[m,x]=(0,d.useState)([]),[f,h]=(0,d.useState)(),[b,g]=(0,d.useState)(),{t:j}=(0,y.Bd)();(0,d.useEffect)((()=>{if(n.field&&n.operation&&n.relationField&&n.values){let e=t.find((e=>e.id.toString()==n.field)),l=i.find((e=>e.id.toString()==n.relationField));e&&l&&n.values&&(console.log(),p({label:e.label,value:e.id.toString(),options:(null===e||void 0===e?void 0:e.basicDataItems)||e.options}),h(n.operation),g({label:l.label,value:l.id.toString()}),x(n.values))}}),[n,t,i]);const _=e=>{let l={...e,saved:!1};o({...l})};return console.log("selecccc",u),(0,c.jsxs)("div",{className:"w-full flex flex-col items-start justify-start px-4 border-b pb-[30px] border-text-400 mb-[18px]",children:[(0,c.jsx)(w.A,{className:"group mb-[30px]",name:"condField",label:"\u0641\u06cc\u0644\u062f",options:t&&t.map((e=>({label:(0,c.jsx)("p",{children:e.label}),value:e.id.toString()}))),placeholder:"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:e=>{let l=t.find((l=>l.id.toString()==e.target.value));console.log("seleeee",l),p({...e,options:(null===l||void 0===l?void 0:l.basicDataItems)||(null===l||void 0===l?void 0:l.options)}),x([]),_({...n,field:e.target.value})},values:{condField:null===u||void 0===u?void 0:u.value}}}),(0,c.jsx)(w.A,{className:"group ".concat(m.length>0?"mb-[15px]":"mb-[30px]"),name:"condFieldValue",label:"\u0628\u0631\u0627\u0628\u0631",options:u&&(null===u||void 0===u||null===(l=u.options)||void 0===l?void 0:l.map((e=>({label:e.label,value:e.id})))),placeholder:u?"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f":"\u0627\u0628\u062a\u062f\u0627 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:e=>{const l=null===u||void 0===u?void 0:u.options;m.findIndex((l=>l.id==e.target.value))>-1||(x([...m,{...l.find((l=>l.id==e.target.value))}]),_({...n,values:[...m,{...l.find((l=>l.id==e.target.value))}]}))},values:{condFieldValue:null}}}),m.length>0&&(0,c.jsx)("div",{className:"flex items-center justify-start w-full mb-[30px]",children:m.map(((e,l)=>(0,c.jsxs)("div",{className:"w-[97px] h-[48px] rounded-[24px] border border-text-400 flex items-center justify-between pe-2 ps-4 me-2",children:[(0,c.jsx)("p",{className:"text-[14px]",children:e.label}),(0,c.jsx)("div",{onClick:()=>(e=>{let l=m.findIndex((l=>l.value==e.value));if(l>-1){let e=m;e.splice(l,1),x([...e]),_({...n,values:[...e]})}})(e),className:"cursor-pointer",children:(0,c.jsx)(v.A,{className:"w-[20px] h-[20px]"})})]},l)))}),(0,c.jsx)(w.A,{className:"group mb-[30px]",name:"operation",label:"\u0639\u0645\u0644\u06cc\u0627\u062a",options:[{label:(0,c.jsx)("p",{children:"\u0646\u0645\u0627\u06cc\u0634"}),value:"show"},{label:(0,c.jsx)("p",{children:"\u0639\u062f\u0645 \u0646\u0645\u0627\u06cc\u0634"}),value:"hide"}],placeholder:"\u0639\u0645\u0644\u06cc\u0627\u062a",formik:{handleChange:e=>{h(e.target),_({...n,operation:e.target})},values:{operation:null===f||void 0===f?void 0:f.value}}}),(0,c.jsx)(w.A,{className:"group mb-[30px]",name:"relationField",label:"\u0641\u06cc\u0644\u062f \u0648\u0627\u0628\u0633\u062a\u0647",options:i&&u&&i.filter((e=>e.id.toString()!=u.value)).map((e=>({label:(0,c.jsx)("p",{children:e.label}),value:e.id.toString()}))),placeholder:u?"\u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f":"\u0627\u0628\u062a\u062f\u0627 \u0641\u06cc\u0644\u062f \u0631\u0627 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",formik:{handleChange:e=>{const l=i.find((l=>l.id.toString()==e.target.value));l&&(g({label:l.label,value:l.id.toString()}),_({...n,relationField:l.id}))},values:{relationField:null===b||void 0===b?void 0:b.value}}}),(0,c.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,c.jsxs)(Q.A,{onClick:()=>{s(n.id)},className:"h-[48px] ".concat(null!==n&&void 0!==n&&n.saved?"w-full":"w-[calc(50%-8px)] me-2"," !rounded-[8px]  !border !border-solid !border-error-primary !text-error-primary "),children:[(0,c.jsx)(v.A,{}),(0,c.jsx)("p",{className:"text-[14px] font-bold ms-1",children:j("deleteCondition")})]}),!(null!==n&&void 0!==n&&n.saved)&&(0,c.jsxs)(Q.A,{onClick:()=>{r(n.id)},className:"h-[48px] w-[calc(50%-8px)] !rounded-[8px] ms-2 !border !border-solid !border-success-primary !text-success-primary",children:[(0,c.jsx)(a.A,{}),(0,c.jsx)("p",{className:"text-[14px] font-bold ms-1",children:j("saveCondition")})]})]})]})};var Y=t(5424);const $=e=>{let{conditionalfields:l,formElements:t,saveConditions:i,savedConditions:a}=e;const[n,o]=(0,d.useState)([...a]);console.log("condiii",n);const{t:s}=(0,y.Bd)(),u=e=>{let l=n.findIndex((l=>l.id==e.id));if(l>-1){let t=n;t[l]=e,o([...t])}},p=e=>{let l=n.findIndex((l=>l.id==e));if(l>-1){let e=n;e.splice(l,1),o([...e])}i([...n]),Y.A.success(s("conditionDeleted"))},v=e=>{let a=n.findIndex((l=>l.id==e));if(a>-1){let e=n[a];if(e.field&&e.operation&&e.values&&e.values.length>0&&e.relationField){if(l.findIndex((l=>l.id==e.field))>-1){let l=t.findIndex((l=>l.id==e.relationField));if(l>-1){if(t[l].readOnly)return void Y.A.error("\u0641\u06cc\u0644\u062f \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647 \u062f\u0631 \u0641\u0631\u0645 \u0642\u0627\u0628\u0644 \u0634\u0631\u0637 \u06af\u0630\u0627\u0631\u06cc \u0646\u06cc\u0633\u062a");let e=n;e[a].saved=!0,o([...e]),i(n),Y.A.success("\u0634\u0631\u0637 \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f")}else Y.A.error("\u0641\u06cc\u0644\u062f \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647 \u062f\u0631 \u0641\u0631\u0645 \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f")}else Y.A.error("\u0641\u06cc\u0644\u062f \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647 \u062f\u0631 \u0641\u0631\u0645 \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f")}else Y.A.error("\u0644\u0637\u0641\u0627 \u062a\u0645\u0627\u0645 \u0641\u06cc\u0644\u062f \u0647\u0627\u06cc \u0634\u0631\u0637 \u0631\u0627 \u067e\u0631 \u06a9\u0646\u06cc\u062f")}};return(0,c.jsxs)("div",{children:[n&&n.map(((e,i)=>(0,c.jsx)(X,{conditionalfields:l,formElements:t,condition:e,setCondition:u,saveCondition:v,deleteCondition:p},i))),(0,c.jsx)("div",{className:"w-full px-[16px]",children:(0,c.jsx)(r.A,{icon:(0,c.jsx)(m.A,{}),text:"\u0627\u0641\u0632\u0648\u062f\u0646 \u0634\u0631\u0637 \u062c\u062f\u06cc\u062f",onClick:()=>{l.length>0&&t.length>=2?o([...n,{id:Math.floor(1e3*Math.random()),field:null,operation:null,values:[],relationField:null,saved:!1}]):Y.A.error("\u0641\u06cc\u0644\u062f \u0647\u0627\u06cc \u0627\u06cc\u062c\u0627\u062f \u0634\u062f\u0647 \u0628\u0631\u0627\u06cc \u0627\u06cc\u062c\u0627\u062f \u0634\u0631\u0637 \u0641\u0631\u0645 \u0645\u0646\u0627\u0633\u0628 \u0646\u0645\u06cc \u0628\u0627\u0634\u0646\u062f")}})})]})},ee=e=>{let{handleChangeTab:l,selectedTab:t,addElement:i,selectedField:a,handleUpdateField:d,handleAddOption:n,handleDeleteOption:o,handleUpdateOption:s,setOnlyImage:r,setRequired:p,formElements:v,saveConditions:m,savedConditions:x,setFromBasicData:f,relatedFields:h}=e;const b=e=>{m(e)};return(0,c.jsxs)("div",{className:"min-h-[800px] basis-1/4 bg-white pt-[20px] me-3 border border-text-300",children:[(0,c.jsx)(u,{handleChange:l,items:[{label:"\u0627\u0644\u0645\u0627\u0646 \u0647\u0627",value:"elements"},{label:"\u0648\u06cc\u0631\u0627\u06cc\u0634 \u0627\u0644\u0645\u0627\u0646",value:"editElement"},{label:"\u0634\u0631\u0637 \u0647\u0627\u06cc \u0641\u0631\u0645",value:"formConditions"}],value:t}),(()=>{switch(t){case"elements":return(0,c.jsx)(Z,{addElement:i,relatedFields:h});case"editElement":return(0,c.jsx)(N,{handleUpdateField:d,selectedField:a,handleAddOption:n,handleUpdateOption:s,handleDeleteOption:o,onlyImage:(null===a||void 0===a?void 0:a.onlyImage)||!1,setOnlyImage:r,required:(null===a||void 0===a?void 0:a.required)||!1,setRequired:p,fromBasicData:!(null===a||void 0===a||!a.basic_data_id),setFromBasicData:f});case"formConditions":return(0,c.jsx)($,{conditionalfields:v.filter((e=>e.options)),formElements:v,saveConditions:b,savedConditions:x});default:return(0,c.jsx)(Z,{addElement:i})}})()]})};var le=t(5937),te=t(3688),ie=t(1802),ae=t(3438),de=t(1461);const ne=e=>{let{formElements:l,setFormElements:t,handleSelectField:i,lastId:a,setLastId:n,selectedField:o,deleteItem:s,saveFormLoading:r}=e;const{t:u}=(0,y.Bd)(["common","validations"]);console.log("el",l);const p=e=>{var l,t;return(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsxs)("div",{className:"flex opacity-0 pointer-events-none\tgroup-hover:pointer-events-auto\t group-hover:opacity-100 transition-all ",children:[(!e.readOnly||e.fromRelatedFields)&&(0,c.jsx)("div",{onClick:()=>m(e),id:"deleteItem",className:"cursor-pointer ms-2 w-[30px] h-[30px] rounded-full border border-error-primary flex items-center justify-center",children:(0,c.jsx)(ae.A,{className:"w-[16px] h-[16px] text-error-primary pointer-events-none"})}),!e.fromRelatedFields&&(0,c.jsx)("div",{onClick:()=>v(e),className:"cursor-pointer ms-2 w-[30px] h-[30px] rounded-full border border-success-primary flex items-center justify-center",children:(0,c.jsx)(le.A,{className:"w-[16px] h-[16px] text-success-primary"})})]}),e.fromRelatedFields&&(0,c.jsxs)("div",{className:"ms-3 bg-secondary-main flex items-center justify-center px-2 py-0.5 rounded-full text-[11px]",children:[u("fromStep")," ",null===(l=e.form)||void 0===l||null===(t=l.step)||void 0===t?void 0:t.step_name]})]})},v=e=>{let i=[...l];const d=i.indexOf(e);d>-1&&(i.splice(d+1,0,{...e,id:a+1,server_id:null,label:e.label+" "+u("copy"),name:e.name+(a+1).toString(),placeholder:e.placeholder+(a+1).toString(),readOnly:!1}),t(i),n(a+1))},m=e=>{s(e)},x=(0,d.useRef)(),f=(0,d.useRef)(),h=e=>{const i=[...l],a=i[x.current];i.splice(x.current,1),i.splice(f.current,0,a),x.current=null,f.current=null,t(i)};return(0,c.jsxs)("div",{className:"px-4 py-6 draggable grid grid-cols-4 gap-y-9 gap-x-4",children:[0===l.length&&!r&&(0,c.jsxs)("div",{className:"col-span-4 flex flex-col items-center justify-center mt-8",children:[(0,c.jsx)("div",{className:"w-[50px] rounded-full h-[50px] bg-primary-main text-white flex items-center justify-center",children:(0,c.jsx)(te.A,{})}),(0,c.jsx)("p",{className:"text-gray-400 text-[16px] font-bold mt-4",children:u("addFieldToStart")})]}),l.map(((e,l)=>(0,c.jsxs)("div",{onDragStart:e=>{return t=l,void(x.current=t);var t},onDragEnter:e=>{return t=l,void(f.current=t);var t},onDragEnd:h,onClick:l=>{"deleteItem"!==l.target.id&&i(e)},draggable:!0,className:"flex lg:col-span-4\n            ".concat(100==e.width?"col-span-4":"","\n            ").concat(75==e.width?"col-span-3":"","\n            ").concat(50==e.width?"col-span-2":"","\n            "),children:[(0,c.jsx)("div",{className:"me-3 cursor-move ".concat((null===o||void 0===o?void 0:o.id)===e.id?"text-primary-main":""),children:(0,c.jsx)(ie.A,{})}),(0,de.dN)(e,p,void 0,!0)]},l)))]})};var oe=t(3216),se=t(7099),re=t(5101);const ce=()=>{var e;const l=(0,o.j)();let{code:t,step_id:u}=(0,oe.g)();const p=(0,o.G)((e=>e.forms.formFieldTypes));(0,d.useEffect)((()=>{l((0,n.J3)(!0))}));const[v,m]=(0,d.useState)("elements"),x=e=>{console.log("value",e),"formConditions"===e&&P(),m(e)},[f,h]=(0,d.useState)([]),[b,g]=(0,d.useState)([]),[j,w]=(0,d.useState)(),[_,A]=(0,d.useState)([]),[N,F]=(0,d.useState)(!0),I=(0,o.G)((e=>e.basicData.basicDatas)),[C,k]=(0,d.useState)(0),S=(0,o.G)((e=>e.products.productStepInfo)),[D,O]=(0,d.useState)(0),{t:E}=(0,y.Bd)(["common","validations"]),B=(0,oe.Zp)();(0,d.useEffect)((()=>(l((0,se.cz)(parseInt(u||"0"))),()=>{l((0,n.J3)(!1)),l((0,se.cz)(parseInt("0")))})),[]);const V=e=>{e?(w(e),x("editElement")):(w(void 0),x("elements"))};(0,d.useEffect)((()=>{var e,l,t,i;S&&p&&((null===(e=S.forms)||void 0===e?void 0:e.length)>0?(F(!0),k(null===(l=S.forms)||void 0===l?void 0:l[0].id),L(null===(t=S.forms)||void 0===t?void 0:t[0].id)):M(S.global_step,null===(i=S.product)||void 0===i?void 0:i.count_type))}),[S,p]);const L=async e=>{const l=await G.A.getForm(e);q(l),q(l,!0),R(l),F(!1)},R=e=>{let{conditions:l,fields:t,id:i}=e,a=[];null===l||void 0===l||l.map((e=>{var l;let i=t.find((l=>l.id===e.form_field_id));console.log("fff",i);let d=null===(l=(null===i||void 0===i?void 0:i.basicDataItems)||(null===i||void 0===i?void 0:i.options))||void 0===l?void 0:l.map((e=>({id:e.id,label:e.label,server_id:e.id,value:e.option})));console.log("fff",d);let n=a.findIndex((l=>l.field===e.form_field_id&&l.relationField===e.relational_form_field_id));if(n>-1){var o,s;let l=null===d||void 0===d?void 0:d.find((l=>l.id==(e.basic_data_item_id||e.form_field_option_id)));console.log("p[topnnnnsss",d),console.log("p[topnnnnsss",l),console.log("p[topnnnnsss",e),null===(o=a[n])||void 0===o||null===(s=o.values)||void 0===s||s.push({id:null===l||void 0===l?void 0:l.id,label:null===l||void 0===l?void 0:l.label,server_id:null===l||void 0===l?void 0:l.id,value:null===l||void 0===l?void 0:l.value})}else{let l=null===d||void 0===d?void 0:d.find((l=>l.id==(e.basic_data_item_id||e.form_field_option_id)));a.push({field:e.form_field_id,id:e.id,operation:1==e.operation?{name:"operation",value:"show"}:{name:"operation",value:"hide"},relationField:e.relational_form_field_id,saved:!0,values:[{id:null===l||void 0===l?void 0:l.id,label:null===l||void 0===l?void 0:l.label,server_id:null===l||void 0===l?void 0:l.id,value:null===l||void 0===l?void 0:l.value}]})}})),console.log("tmp123",[...a]),A([...a])},q=(e,l)=>{let t=[],i=l?e.relatedFields:e.fields;console.log("formId",e.id),null===i||void 0===i||i.forEach((l=>{var i,a,d,n,o,s,r,u,p,v,m;let x={id:l.id,name:l.name,type:null===(i=l.type)||void 0===i?void 0:i.type,width:l.width||100,typeId:l.form_field_type_id,label:l.label,placeholder:l.placeholder,required:l.required,basic_data:l.basic_data,basic_data_id:(null===(a=l.basic_data)||void 0===a?void 0:a.id)||null,form:l.form&&(null===(d=l.form)||void 0===d?void 0:d.id)!=e.id?l.form:null,fromRelatedFields:!(null===(n=l.form)||void 0===n||!n.id||(null===(o=l.form)||void 0===o?void 0:o.id)==e.id),basicDataItems:(l.basicDataItems&&l.basicDataItems.length>0||(null===(s=l.type)||void 0===s?void 0:s.has_options))&&(null===(r=l.basicDataItems)||void 0===r?void 0:r.map((e=>({id:e.id,server_id:e.id,value:e.option,label:(0,c.jsx)("p",{children:e.label})})))),options:(l.options&&l.options.length>0||(null===(u=l.type)||void 0===u?void 0:u.has_options))&&(null===(p=l.options)||void 0===p?void 0:p.map((e=>({id:e.id,server_id:e.id,value:e.option,label:(0,c.jsx)("p",{children:e.label})})))),onlyImage:null===(v=JSON.parse(l.validation))||void 0===v?void 0:v.onlyImage,server_id:l.id,readOnly:null===(m=JSON.parse(l.validation))||void 0===m?void 0:m.readOnly};t.push(x)})),l?g(t):h(t)},M=async(e,l)=>{var t;const i=null===e||void 0===e?void 0:e.description,a=await G.A.createForm({name:"form"+(null===S||void 0===S?void 0:S.id),product_id:null===S||void 0===S?void 0:S.product_id,product_steps:null===S||void 0===S||null===(t=S.id)||void 0===t?void 0:t.toString()});var d,n;(k(a.id),"initialOrder"===i&&"m2"===l)&&await G.A.updateForm(a.id,{conditions:[],fields:[{basic_data_id:null,form_field_type_id:null===p||void 0===p||null===(d=p.find((e=>"number"==e.type)))||void 0===d?void 0:d.id,helper_text:1,label:"\u0639\u0631\u0636",max:100,min:1,name:"width",order:0,origin_form_id:null,placeholder:"\u0639\u0631\u0636 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",required:!0,validation:'{"readOnly":true}'},{basic_data_id:null,form_field_type_id:null===p||void 0===p||null===(n=p.find((e=>"number"==e.type)))||void 0===n?void 0:n.id,helper_text:2,label:"\u0627\u0631\u062a\u0641\u0627\u0639",max:100,min:1,name:"height",order:1,origin_form_id:null,placeholder:"\u0627\u0631\u062a\u0641\u0627\u0639 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",required:!0,validation:'{"readOnly":true}'}],name:"form"+(null===S||void 0===S?void 0:S.id)});L(a.id),F(!1)},P=async(e,l)=>{F(!0);let t=[...f],i=[..._];console.log("pass",f),l&&(i=[...l]),console.log("tmp",t);let a=t.map((e=>e.name)),d=a.filter(((e,l)=>a.indexOf(e)!=l));if(d.length>0){let e=t.filter((e=>d.includes(e.name))).map((e=>e.label));return Y.A.error(E("validations:fieldNamesMustBeUnique")+e),void F(!1)}let n=G.A.updateForm(C,{name:"form"+(null===S||void 0===S?void 0:S.id),fields:t.map(((e,l)=>{var t,a;let d={};return"uploadFile"===e.type&&(d.onlyImage=e.onlyImage),e.readOnly&&(d.readOnly=e.readOnly),console.log("condTmp",i),{server_id:e.server_id,name:e.name,form_field_type_id:e.typeId,label:e.label,placeholder:e.placeholder,required:e.required,helper_text:e.id,validation:JSON.stringify(d),min:1,max:100,order:l,origin_form_id:e.fromRelatedFields?e.form.id:null,hasOptions:e.options&&e.options.length>0,basic_data:e.basic_data,basic_data_id:e.basic_data_id||null,width:+e.width||100,basicDataItems:e.basicDataItems&&e.basicDataItems.length>0&&(null===(t=e.basicDataItems)||void 0===t?void 0:t.map((e=>({id:e.id,server_id:e.id,value:e.option,label:(0,c.jsx)("p",{children:e.label})})))),options:e.options&&e.options.length>0&&(null===(a=e.options)||void 0===a?void 0:a.map((e=>({option:e.value,label:e.label.props.children,id:e.server_id}))))}})),conditions:i.map(((e,l)=>{var t,i;return{form_id:C,form_field_id:e.field,form_field_options_id:null===(t=e.values)||void 0===t?void 0:t.map((e=>e.id)),operation:"show"===(null===(i=e.operation)||void 0===i?void 0:i.value)?1:0,relational_form_field_id:e.relationField}}))});n.then((e=>{console.log("updated!",e),q(e),R(e),q(e,!0),F(!1),Y.A.success(E("formSavedSuccessfully"))})),n.catch((e=>{F(!1),Y.A.error(E("formSaveError"))}))};return(0,c.jsxs)("div",{className:"w-full h-full",children:[N&&(0,c.jsx)(re.A,{}),(0,c.jsx)(s.A,{handleBack:()=>{B("/products/".concat(t,"/steps"))},actions:(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)("div",{className:"w-[186px]",children:(0,c.jsx)(r.A,{icon:(0,c.jsx)(i.A,{}),text:E("viewForm"),onClick:()=>{},gray:!0})}),(0,c.jsx)("div",{className:"w-[138px] ms-4",children:(0,c.jsx)(r.A,{icon:(0,c.jsx)(a.A,{}),text:E("saveForm"),onClick:P})})]}),title:"".concat(E("formBuilder")," ").concat(E("step")," ").concat(null===S||void 0===S?void 0:S.step_name," ").concat(E("product")," ").concat(null===S||void 0===S||null===(e=S.product)||void 0===e?void 0:e.name)}),(0,c.jsxs)("div",{className:"w-full flex",children:[(0,c.jsx)(ee,{handleChangeTab:x,selectedTab:v,addElement:(e,l,t)=>{let i={name:"input"+e+(D+1).toString(),placeholder:e+(D+1).toString(),label:"\u0639\u0646\u0648\u0627\u0646 \u0641\u06cc\u0644\u062f",width:100,type:e,typeId:l,required:!1,id:D+1};if("dropDown"!==e&&"checkbox"!==e||(i={...i,options:[]}),"uploadFile"===e&&(i={...i,onlyImage:!1}),t){let e=b.find((e=>e.server_id==l));e&&(i={...e,fromRelatedFields:t})}h([...f,i]),O(D+1)},selectedField:j,handleUpdateField:e=>{let l=[...f],t=l.findIndex((l=>l.id==e.id));-1!==t&&(l[t]={...e},h([...l]),w({...e}))},handleAddOption:(e,l)=>{let t=[...f],i=t.findIndex((l=>l.id==e));if(-1!==i&&t[i].options){const e=t[i].options||[];t[i]={...t[i],options:[...e,{...l,id:Math.floor(100*Math.random())}]},h([...t]),w({...t[i]})}},handleUpdateOption:(e,l,t)=>{let i=[...f],a=i.findIndex((l=>l.id==e));if(-1!==a&&i[a].options){let e=i[a].options||[];e[t]=l,i[a]={...i[a],options:[...e]},h([...i]),w({...i[a]})}},handleDeleteOption:(e,l,t)=>{let i=[...f],a=i.findIndex((l=>l.id==e));if(-1!==a&&i[a].options){let e=[...i[a].options||[]],t=e.findIndex((e=>e.value==l));t>-1&&(e.splice(t,1),i[a]={...i[a],options:[...e]},h([...i]),w({...i[a]}))}t&&G.A.deleteOption(t).then((e=>{}))},setOnlyImage:e=>{let l=[...f],t=l.findIndex((e=>e.id==(null===j||void 0===j?void 0:j.id)));t>-1&&(l[t]={...l[t],onlyImage:e},h([...l]),w({...l[t]}))},setRequired:e=>{let l=[...f],t=l.findIndex((e=>e.id==(null===j||void 0===j?void 0:j.id)));t>-1&&(l[t]={...l[t],required:e},h([...l]),w({...l[t]}))},formElements:f,saveConditions:e=>{A([...e.filter((e=>e.saved))]),console.log("[...conditions.filter((x) => x.saved)]",[...e.filter((e=>e.saved))]),P(null,[...e.filter((e=>e.saved))])},savedConditions:_,setFromBasicData:e=>{let l=[...f],t=l.findIndex((e=>e.id==(null===j||void 0===j?void 0:j.id)));if(t>-1){var i;let a=(null===(i=l[t].basic_data)||void 0===i?void 0:i.id)||(null===I||void 0===I?void 0:I[0].id);console.log("bas",a),l[t]={...l[t],basic_data_id:1==e?a:null,basic_data:1==e?l[t].basic_data||(null===I||void 0===I?void 0:I[0]):null,basicDataItems:1==e?(l[t].basic_data||(null===I||void 0===I?void 0:I[0])).items.map((e=>({id:e.id,label:(0,c.jsx)("p",{children:e.name}),server_id:e.id,value:e.code}))):null},h([...l]),w({...l[t]})}},relatedFields:b}),(0,c.jsx)("div",{className:"basis-3/4 bg-white ms-2",children:(0,c.jsx)(ne,{lastId:D,setLastId:O,saveFormLoading:N,formElements:f,selectedField:j,setFormElements:h,handleSelectField:V,deleteItem:async e=>{try{F(!0),e.server_id&&await G.A.deleteItem(e.server_id,C);let l=[...f];const t=l.indexOf(e);t>-1&&(l.splice(t,1),h(l),e.id==(null===j||void 0===j?void 0:j.id)&&V(void 0)),Y.A.success(E("fieldDeletedSuccessfully")),F(!1)}catch(l){F(!1)}}})})]})]})}}}]);
//# sourceMappingURL=6313.51ea7e74.chunk.js.map