"use strict";(self.webpackChunknipa_panel_new=self.webpackChunknipa_panel_new||[]).push([[4648],{4018:(e,i,a)=>{a.d(i,{A:()=>l});var d=a(670);const l={ordersList:async function(){var e;let i=await(null===(e=(0,d.A)())||void 0===e?void 0:e.get("/order"));return null===i||void 0===i?void 0:i.data},createOrder:async function(e){var i;let a=await(null===(i=(0,d.A)())||void 0===i?void 0:i.post("/order",e));return null===a||void 0===a?void 0:a.data},createOrderGroup:async function(e){var i;let a=await(null===(i=(0,d.A)())||void 0===i?void 0:i.post("/orderGroup",{customer_code:e}));return null===a||void 0===a?void 0:a.data},orderGroupsList:async function(){var e;let i=await(null===(e=(0,d.A)())||void 0===e?void 0:e.get("/orderGroup"));return null===i||void 0===i?void 0:i.data},orderDetail:async function(e){var i;let a=await(null===(i=(0,d.A)())||void 0===i?void 0:i.get("/order/"+e));return null===a||void 0===a?void 0:a.data},getCompleteInfo:async function(e){var i;let a=await(null===(i=(0,d.A)())||void 0===i?void 0:i.get("/order/"+e+"/complete"));return null===a||void 0===a?void 0:a.data},getStepInfo:async function(e,i){var a;let l=await(null===(a=(0,d.A)())||void 0===a?void 0:a.get("/step/"+e+"/"+i+"/complete"));return null===l||void 0===l?void 0:l.data}}},4648:(e,i,a)=>{a.r(i),a.d(i,{default:()=>_});var d=a(5101),l=a(3232),t=a(3216),o=a(4117),n=a(5043),r=a(3516),s=a(1461),u=a(4018),v=a(979),c=a(3033),p=a(7578),f=a(5424),m=a(579);const _=()=>{var e;const i=(0,t.Zp)(),{t:a}=(0,o.Bd)();let{orderId:_,stepId:b}=(0,t.g)();const[x,w]=(0,n.useState)(!1),[y,h]=(0,n.useState)([]),[g,A]=(0,n.useState)(),[S,j]=(0,n.useState)(),[I,k]=(0,n.useState)([]),[N,F]=(0,n.useState)(),[O,C]=(0,n.useState)(),D=(0,r.Wx)({initialValues:O,validationSchema:N,enableReinitialize:!0,onSubmit:async e=>{if(console.log("done!",g),_&&g){w(!0);await v.A.addUserAnswer(parseInt(_),g.id,e);w(!1),f.A.success(a("submitFormSuccess")),i("/orders/")}}});(0,n.useEffect)((()=>{console.log("called!",y),C((0,s.rS)(y)),F(c.Ik().shape((0,s.Cw)(y,I,D)))}),[y,I]),(0,n.useEffect)((()=>{G()}),[]);const G=async()=>{var e;let i=await u.A.getStepInfo(Number(b),Number(_));j(i);const a=await v.A.getForm(null===i||void 0===i?void 0:i.form.id,_);A(a);let d=[];null===(e=a.fields)||void 0===e||e.map((e=>{var i,l;let t={key:e.id,name:e.name,placeholder:e.placeholder,label:e.label,type:e.type.type,typeId:e.type.id,required:e.required,answer:e.userAnswer,id:e.id,fromRelatedFields:!(null===e||void 0===e||null===(i=e.form)||void 0===i||!i.id||(null===e||void 0===e||null===(l=e.form)||void 0===l?void 0:l.id)==(null===a||void 0===a?void 0:a.id))};var o;("dropDown"!==e.type.type&&"checkbox"!==e.type.type||(t=e.basic_data_id?{...t,basic_data:e.basic_data,basic_data_id:e.basic_data_id,basicDataItems:e.basicDataItems.map((e=>({key:e.id,id:e.id,label:(0,m.jsx)("p",{children:e.label}),server_id:e.id,value:e.option}))),answer:e.userAnswer}:{...t,options:e.options.map((i=>({id:i.id,key:i.id,label:(0,m.jsx)("p",{children:i.label}),server_id:i.id,value:i.option,answer:e.userAnswer})))}),"uploadFile"===e.type.type)&&(t={...t,onlyImage:null===(o=JSON.parse(e.validation))||void 0===o?void 0:o.onlyImage,setPending:w,noBadge:!0});d.push({...t})})),k([...a.conditions]),h([...d])};return(0,m.jsxs)("div",{className:"w-full h-full",children:[(0,m.jsx)(l.A,{title:(null===S||void 0===S||null===(e=S.step)||void 0===e?void 0:e.step_name)||"",handleBack:()=>i("/orders")}),(0,m.jsx)("div",{className:"w-full flex gap-x-[20px]",children:(0,m.jsx)("div",{className:"w-full bg-white border border-text-300 h-min rounded-[6px] px-[20px] py-[24px]",children:(0,m.jsxs)("form",{onSubmit:D.handleSubmit,children:[x&&(0,m.jsx)(d.A,{}),(0,m.jsx)("div",{children:y&&D&&(null===D||void 0===D?void 0:D.values)&&Object.keys(null===D||void 0===D?void 0:D.values).length>0&&y.map(((e,i)=>{const a=I.find((i=>i.relational_form_field_id==e.id));let d=!0;if(a){const e=y.find((e=>e.id==a.form_field_id));let i;var l,t,o,n;if(e)if(e.basic_data_id)i=null===e||void 0===e||null===(l=e.basicDataItems)||void 0===l?void 0:l.find((e=>e.server_id==a.form_field_option_id));else i=null===e||void 0===e||null===(t=e.options)||void 0===t?void 0:t.find((e=>e.server_id==a.form_field_option_id));if(e&&i)if(1==a.operation)d=D.values[e.name]===i.value||(null===(o=D.values[e.name])||void 0===o?void 0:o.indexOf(i.value))>-1;else d=!(D.values[e.name]===i.value||(null===(n=D.values[e.name])||void 0===n?void 0:n.indexOf(i.value))>-1)}return d?(0,m.jsx)("div",{className:"mt-[30px]",children:(0,s.dN)(e,(()=>{}),D)},i):(0,m.jsx)(m.Fragment,{})}))}),(0,m.jsx)("div",{className:"mt-[32px]",children:(0,m.jsx)(p.A,{after:!0,onClick:()=>{console.log("formi",D.values)},text:a("submitForm2")})})]})})})]})}}}]);
//# sourceMappingURL=4648.a5003195.chunk.js.map